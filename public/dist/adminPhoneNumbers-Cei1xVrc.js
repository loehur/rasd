import{r as d,j as D,c as o,o as r,p as z,a as e,d as g,b as B,e as _,v as w,t as i,F as V,l as F,w as I,g as S,n as T,h as L}from"./tailwind-D--riiXg.js";import{_ as U}from"./AdminHeader-D0GvlDZc.js";import{A as k}from"./api-rG_fphBW.js";const R={class:"min-h-screen bg-gray-50"},q={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},J={class:"bg-white rounded-xl shadow-sm border border-gray-200"},O={class:"px-6 py-4 border-b border-gray-200"},Q={class:"mt-4"},Y={class:"flex gap-3"},G={class:"flex-1"},H={key:0,class:"mt-1 text-sm text-red-600"},K=["disabled"],W={key:0,class:"p-8 text-center"},X={key:1,class:"p-8 text-center text-red-600"},Z={key:2,class:"overflow-x-auto"},ee={class:"w-full"},te={class:"bg-white divide-y divide-gray-200"},se={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},ae={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},oe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-600"},re={class:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-blue-600"},ne={class:"px-6 py-4 text-sm text-gray-600"},le={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-600"},ie={class:"px-6 py-4 whitespace-nowrap text-sm"},de={class:"flex gap-2"},ue=["onClick"],ce=["onClick"],pe={key:3,class:"p-8 text-center text-gray-500"},me={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},he={class:"bg-white rounded-xl shadow-xl p-6 max-w-md w-full mx-4"},xe={class:"flex gap-3 justify-end"},be=["disabled"],ge={class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ye={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},ve={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},fe={__name:"AdminPhoneNumbersApp",setup(_e){const y=d([]),v=d(!0),h=d(""),b=d(!1),p=d({show:!1,message:"",type:"success"}),n=d(""),m=d(""),f=d(!1),l=d({id:null,phone_number:"",remarks:""});D(()=>{x()});const x=async()=>{v.value=!0,h.value="";try{const a=localStorage.getItem("auth_token");let t=`${k}/api/phone-numbers`;n.value&&n.value.length>=8&&(t+=`?search=${encodeURIComponent(n.value)}`);const c=await(await fetch(t,{headers:{Authorization:`Bearer ${a}`,Accept:"application/json"}})).json();c.success?y.value=c.data:h.value=c.message||"Failed to fetch phone numbers"}catch(a){h.value="Failed to connect to server",console.error("Error:",a)}finally{v.value=!1}},P=()=>{m.value="",n.value.length>0&&n.value.length<8&&(m.value="Please enter at least 8 digits")},A=async()=>{if(n.value.length>0&&n.value.length<8){m.value="Please enter at least 8 digits";return}x()},C=()=>{n.value="",m.value="",x()},E=a=>{l.value={id:a.id,phone_number:a.phone_number,remarks:a.remarks},f.value=!0},j=async()=>{if(!l.value.phone_number.trim()){u("Please enter a phone number","error");return}if(!l.value.remarks.trim()){u("Please enter remarks","error");return}b.value=!0;try{const a=localStorage.getItem("auth_token"),s=await(await fetch(`${k}/api/phone-numbers/${l.value.id}`,{method:"PUT",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({phone_number:l.value.phone_number,remarks:l.value.remarks})})).json();s.success?(u("Phone number updated successfully!","success"),N(),x()):u(s.message||"Failed to update phone number","error")}catch(a){u("Failed to connect to server","error"),console.error("Error:",a)}finally{b.value=!1}},N=()=>{f.value=!1,l.value={id:null,phone_number:"",remarks:""}},$=async a=>{if(confirm("Are you sure you want to delete this phone number?"))try{const t=localStorage.getItem("auth_token"),c=await(await fetch(`${k}/api/phone-numbers/${a}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`,Accept:"application/json"}})).json();c.success?(u("Phone number deleted successfully","success"),x()):u(c.message||"Failed to delete phone number","error")}catch(t){u("Failed to connect to server","error"),console.error("Error:",t)}},M=a=>a?new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-",u=(a,t="success")=>{p.value={show:!0,message:a,type:t},setTimeout(()=>{p.value.show=!1},3e3)};return(a,t)=>(r(),o("div",R,[z(U),e("main",q,[t[6]||(t[6]=B('<div class="mb-6"><h1 class="text-2xl font-bold text-gray-900">Phone Numbers Management</h1><p class="text-sm text-gray-600 mt-1">View, edit, and manage phone numbers from all staff</p></div><div class="mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4"><div class="flex items-start gap-3"><svg class="w-5 h-5 text-blue-600 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><p class="text-sm text-blue-800"> As admin, you can view all phone numbers from all staff. You can edit and delete entries, but cannot add new ones (staff add their own data). </p></div></div>',2)),e("div",J,[e("div",O,[t[3]||(t[3]=e("div",{class:"flex items-center justify-between"},[e("h2",{class:"text-lg font-bold text-gray-900"},"Phone Numbers List"),e("div",{class:"text-sm text-gray-600"},"Showing last 20 entries")],-1)),e("div",Q,[e("div",Y,[e("div",G,[_(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>n.value=s),type:"text",placeholder:"Search phone number (min. 8 digits)",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",onInput:P},null,544),[[w,n.value]]),m.value?(r(),o("p",H,i(m.value),1)):g("",!0)]),e("button",{onClick:A,disabled:n.value.length>0&&n.value.length<8,class:"px-6 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed"}," Search ",8,K),n.value?(r(),o("button",{key:0,onClick:C,class:"px-6 py-2 bg-gray-600 text-white font-semibold rounded-lg hover:bg-gray-700"}," Clear ")):g("",!0)])])]),v.value?(r(),o("div",W,[...t[4]||(t[4]=[e("div",{class:"inline-block h-8 w-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"},null,-1),e("p",{class:"mt-2 text-gray-600"},"Loading...",-1)])])):h.value?(r(),o("div",X,i(h.value),1)):y.value.length>0?(r(),o("div",Z,[e("table",ee,[t[5]||(t[5]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Employee ID "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Employee Name "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Team Leader "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Phone Number "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Remarks "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Date Added "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",te,[(r(!0),o(V,null,F(y.value,s=>(r(),o("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",se,i(s.staff_id),1),e("td",ae,i(s.employee_name),1),e("td",oe,i(s.team_leader_name||"-"),1),e("td",re,i(s.phone_number),1),e("td",ne,i(s.remarks||"-"),1),e("td",le,i(M(s.created_at)),1),e("td",ie,[e("div",de,[e("button",{onClick:c=>E(s),class:"text-blue-600 hover:text-blue-800 font-medium"}," Edit ",8,ue),e("button",{onClick:c=>$(s.id),class:"text-red-600 hover:text-red-800 font-medium"}," Delete ",8,ce)])])]))),128))])])])):(r(),o("div",pe," No phone numbers found. "))])]),f.value?(r(),o("div",me,[e("div",he,[t[9]||(t[9]=e("h3",{class:"text-xl font-bold text-gray-900 mb-4"},"Edit Phone Number",-1)),e("form",{onSubmit:I(j,["prevent"]),class:"space-y-4"},[e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[S(" Phone Number "),e("span",{class:"text-red-500"},"*")],-1)),_(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>l.value.phone_number=s),type:"tel",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,512),[[w,l.value.phone_number]])]),e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[S(" Remarks "),e("span",{class:"text-red-500"},"*")],-1)),_(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>l.value.remarks=s),type:"text",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,512),[[w,l.value.remarks]])]),e("div",xe,[e("button",{type:"button",onClick:N,class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50"}," Cancel "),e("button",{type:"submit",disabled:b.value,class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50"},i(b.value?"Saving...":"Save Changes"),9,be)])],32)])])):g("",!0),p.value.show?(r(),o("div",{key:1,class:T(["fixed top-4 right-4 px-6 py-4 rounded-lg shadow-lg z-50 flex items-center space-x-3",p.value.type==="success"?"bg-green-500":"bg-red-500","text-white"])},[(r(),o("svg",ge,[p.value.type==="success"?(r(),o("path",ye)):(r(),o("path",ve))])),e("span",null,i(p.value.message),1)],2)):g("",!0)]))}};L(fe).mount("#app");
