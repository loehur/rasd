const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/api-CrpQcQBv.js","assets/api-n_PshMHp.js"])))=>i.map(i=>d[i]);
import{r as v,j as U,c as n,o as d,a as e,d as f,g as N,t as m,w as $,e as S,v as E,F as A,l as C,n as R,h as j}from"./tailwind-XrDIfzaI.js";import{A as w}from"./api-n_PshMHp.js";const B="modulepreload",T=function(y){return"/"+y},P={},I=function(u,b,p){let x=Promise.resolve();if(b&&b.length>0){let _=function(a){return Promise.all(a.map(r=>Promise.resolve(r).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),c=i?.nonce||i?.getAttribute("nonce");x=_(b.map(a=>{if(a=T(a),a in P)return;P[a]=!0;const r=a.endsWith(".css"),g=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${g}`))return;const o=document.createElement("link");if(o.rel=r?"stylesheet":B,r||(o.as="script"),o.crossOrigin="",o.href=a,c&&o.setAttribute("nonce",c),document.head.appendChild(o),r)return new Promise((s,t)=>{o.addEventListener("load",s),o.addEventListener("error",()=>t(new Error(`Unable to preload CSS for ${a}`)))})}))}function h(i){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=i,window.dispatchEvent(c),!c.defaultPrevented)throw i}return x.then(i=>{for(const c of i||[])c.status==="rejected"&&h(c.reason);return u().catch(h)})},O={class:"min-h-screen bg-slate-950 text-slate-100"},D={class:"px-3 sm:px-6 lg:px-8 py-4"},L={class:"max-w-4xl mx-auto space-y-6"},M={class:"bg-slate-900/70 backdrop-blur border border-slate-800/80 rounded-2xl p-6"},V={class:"flex items-center justify-between mb-4"},z={class:"text-xs px-2 py-1 rounded bg-slate-800/60 border border-slate-700"},J={key:0,class:"p-4 bg-yellow-500/10 border border-yellow-500/30 rounded-xl text-yellow-400"},q={key:1},F={class:"sm:col-span-2 flex justify-end"},X=["disabled"],G={class:"overflow-x-auto -mx-3 sm:mx-0 hidden md:block"},H={class:"min-w-full text-sm"},W={class:"py-2 break-words px-3 sm:px-0"},K={class:"py-2 break-words px-3 sm:px-0"},Q={class:"py-2"},Y={class:"py-2 flex items-center gap-2"},Z=["onClick"],ee=["onClick"],te={class:"md:hidden space-y-3"},se={class:"flex items-center justify-between"},oe={class:"text-sm font-semibold text-slate-100"},re={class:"text-xs text-slate-400"},ae={class:"text-xs px-2 py-1 rounded bg-slate-700 text-slate-300"},le={class:"mt-3 flex gap-2"},ne=["onClick"],de=["onClick"],ie={class:"text-white"},ce={__name:"UsersPage",setup(y){const u=v({role:""}),b=v([]),p=v({name:"",phone_number:""}),x=v(!1),h=v({show:!1,message:"",type:"success"});U(async()=>{const o=localStorage.getItem("user");if(!o){window.location.href="/admin";return}u.value=JSON.parse(o),await i()});const i=async()=>{try{const o=localStorage.getItem("auth_token"),s=JSON.parse(localStorage.getItem("user")||"{}").role,l=await(await fetch(`${w}/api/users`,{method:"GET",headers:{Authorization:`Bearer ${o}`,"X-Role":s}})).json();l.success&&(b.value=l.data)}catch(o){console.error("Load users error:",o)}},c=async()=>{x.value=!0;try{const o=localStorage.getItem("auth_token"),s=JSON.parse(localStorage.getItem("user")||"{}").role,l=await(await fetch(`${w}/api/users`,{method:"POST",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json","X-Role":s},body:JSON.stringify({name:p.value.name,phone_number:p.value.phone_number})})).json();l.success?(r("Admin user created"),p.value={name:"",phone_number:""},await i()):r(l.message||"Failed to create","error")}catch{r("Error creating user","error")}finally{x.value=!1}},_=async o=>{try{const s=localStorage.getItem("auth_token"),t=JSON.parse(localStorage.getItem("user")||"{}").role,k=await(await fetch(`${w}/api/users/${o}/reset-password`,{method:"POST",headers:{Authorization:`Bearer ${s}`,"X-Role":t}})).json();k.success?r('Password reset to "Admin123!"'):r(k.message||"Reset failed","error")}catch{r("Error resetting password","error")}},a=async o=>{try{if(u.value.role!=="super-admin"){r("Forbidden","error");return}const{deleteUser:s}=await I(async()=>{const{deleteUser:l}=await import("./api-CrpQcQBv.js");return{deleteUser:l}},__vite__mapDeps([0,1])),t=await s(o);t.success?(r("User deleted"),await i()):r(t.message||"Delete failed","error")}catch{r("Error deleting user","error")}},r=(o,s="success")=>{h.value={show:!0,message:o,type:s},setTimeout(()=>{h.value.show=!1},3e3)},g=()=>{window.location.href="/admin/dashboard"};return(o,s)=>(d(),n("div",O,[e("main",D,[e("div",L,[e("div",{class:"mb-4"},[e("button",{onClick:g,class:"text-slate-400 hover:text-slate-200 flex items-center gap-2 transition"},[...s[2]||(s[2]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),N(" Back to Dashboard ",-1)])])]),e("div",M,[e("div",V,[s[3]||(s[3]=e("h2",{class:"text-xl font-bold"},"Manage Users",-1)),e("span",z,"Role: "+m(u.value.role),1)]),u.value.role!=="super-admin"?(d(),n("div",J," Hanya super-admin yang dapat mengakses halaman Users. ")):(d(),n("div",q,[e("form",{onSubmit:$(c,["prevent"]),class:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 mb-6"},[e("div",null,[s[4]||(s[4]=e("label",{class:"block text-sm text-slate-300 mb-2"},"Name *",-1)),S(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>p.value.name=t),type:"text",required:"",class:"w-full px-3 sm:px-4 py-2 bg-slate-800/50 border border-slate-700 rounded-lg"},null,512),[[E,p.value.name]])]),e("div",null,[s[5]||(s[5]=e("label",{class:"block text-sm text-slate-300 mb-2"},"Phone Number *",-1)),S(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>p.value.phone_number=t),type:"text",required:"",class:"w-full px-3 sm:px-4 py-2 bg-slate-800/50 border border-slate-700 rounded-lg"},null,512),[[E,p.value.phone_number]])]),e("div",F,[e("button",{disabled:x.value,class:"w-full sm:w-auto px-5 sm:px-6 py-2 bg-emerald-600 hover:bg-emerald-700 rounded-lg text-white disabled:opacity-50"},m(x.value?"Saving...":"Add Admin"),9,X)])],32),e("div",G,[e("table",H,[s[6]||(s[6]=e("thead",null,[e("tr",{class:"text-left text-slate-300 border-b border-slate-800"},[e("th",{class:"py-2 px-3 sm:px-0"},"Name"),e("th",{class:"py-2 px-3 sm:px-0"},"Phone"),e("th",{class:"py-2"},"Role"),e("th",{class:"py-2"},"Actions")])],-1)),e("tbody",null,[(d(!0),n(A,null,C(b.value,t=>(d(),n("tr",{key:t.id,class:"border-b border-slate-800"},[e("td",W,m(t.name),1),e("td",K,m(t.phone_number),1),e("td",Q,m(t.role),1),e("td",Y,[t.role!=="super-admin"&&u.value.role==="super-admin"?(d(),n("button",{key:0,onClick:l=>_(t.id),class:"w-full sm:w-auto px-3 py-1 text-sm bg-blue-600 hover:bg-blue-700 rounded text-white"}," Reset ",8,Z)):f("",!0),t.role!=="super-admin"&&u.value.role==="super-admin"?(d(),n("button",{key:1,onClick:l=>a(t.id),class:"w-full sm:w-auto px-3 py-1 text-sm bg-red-600 hover:bg-red-700 rounded text-white"}," Delete ",8,ee)):f("",!0)])]))),128))])])]),e("div",te,[(d(!0),n(A,null,C(b.value,t=>(d(),n("div",{key:t.id,class:"p-4 bg-slate-800/50 border border-slate-700 rounded-xl"},[e("div",se,[e("div",null,[e("p",oe,m(t.name),1),e("p",re,m(t.phone_number),1)]),e("span",ae,m(t.role),1)]),e("div",le,[t.role!=="super-admin"&&u.value.role==="super-admin"?(d(),n("button",{key:0,onClick:l=>_(t.id),class:"flex-1 px-3 py-2 text-xs bg-blue-600 hover:bg-blue-700 rounded text-white"}," Reset ",8,ne)):f("",!0),t.role!=="super-admin"&&u.value.role==="super-admin"?(d(),n("button",{key:1,onClick:l=>a(t.id),class:"flex-1 px-3 py-2 text-xs bg-red-600 hover:bg-red-700 rounded text-white"}," Delete ",8,de)):f("",!0)])]))),128))])]))]),h.value.show?(d(),n("div",{key:0,class:R(["fixed top-4 left-1/2 -translate-x-1/2 sm:left-auto sm:translate-x-0 sm:right-4 px-4 sm:px-6 py-3 sm:py-4 rounded-lg shadow-lg z-50",h.value.type==="success"?"bg-green-600":"bg-red-600"])},[e("span",ie,m(h.value.message),1)],2)):f("",!0)])])]))}};j(ce).mount("#app");
