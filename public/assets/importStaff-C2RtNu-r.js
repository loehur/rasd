import{r as d,c as s,o as l,a as t,g as u,j as P,w as y,n as S,t as n,u as T,F as k,k as w,b as z}from"./tailwind-Dc7V7I5s.js";import{A as D}from"./api-Cy7OVMSJ.js";const L={class:"min-h-screen bg-slate-950 text-slate-100 p-6"},N={class:"max-w-4xl mx-auto"},R={class:"bg-slate-900/70 backdrop-blur border border-slate-800/80 rounded-2xl p-6 mb-6"},U={key:0,class:"w-16 h-16 mx-auto mb-4 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},H={key:1,class:"mb-4"},O={class:"text-lg font-semibold text-emerald-400"},K={class:"text-sm text-slate-400 mt-1"},q={key:2},G={class:"mt-4 flex items-center justify-between"},J=["href"],Q={key:0,class:"bg-slate-900/70 backdrop-blur border border-slate-800/80 rounded-2xl p-6 mb-6"},W={class:"text-lg font-bold text-slate-100 mb-4"},X={class:"overflow-x-auto"},Y={class:"w-full text-sm border-collapse border border-slate-700 rounded-lg"},Z={class:"bg-slate-800/50"},ee={key:0,class:"text-xs text-slate-500 mt-2"},te={key:1,class:"flex gap-4"},se=["disabled"],le={key:0,class:"w-5 h-5 border-2 border-white/70 border-t-transparent rounded-full animate-spin"},re={class:"font-semibold mb-2"},oe={key:0,class:"mt-2"},ae={class:"text-xs space-y-1 max-h-40 overflow-y-auto"},ne={__name:"ImportStaff",setup(ie){const a=d(null),p=d([]),i=d([]),b=d(!1),v=d(!1),c=d(""),x=d(!1),h=d([]),B=r=>{const e=r.target.files[0];e&&e.type==="text/csv"?(a.value=e,_(e)):alert("Please select a valid CSV file")},F=r=>{b.value=!1;const e=r.dataTransfer.files[0];e&&e.type==="text/csv"&&(a.value=e,_(e))},_=r=>{const e=new FileReader;e.onload=o=>{const m=o.target.result.split(`
`).filter(f=>f.trim());m.length>0&&(p.value=m[0].split(",").map(f=>f.trim()),i.value=m.slice(1).map(f=>{const A=f.split(","),C={};return p.value.forEach(($,E)=>{C[$]=A[E]?.trim()||""}),C}))},e.readAsText(r)},V=()=>{a.value=null,p.value=[],i.value=[],c.value=""},j=r=>r<1024?r+" B":r<1048576?(r/1024).toFixed(2)+" KB":(r/1048576).toFixed(2)+" MB",I=async()=>{if(a.value){v.value=!0,c.value="",h.value=[];try{const r=new FormData;r.append("file",a.value);const o=await(await fetch(`${D}/api/staff/import`,{method:"POST",headers:{Accept:"application/json"},body:r})).json();o.success?(x.value=!0,c.value=o.message,o.data.errors&&o.data.errors.length>0&&(h.value=o.data.errors)):(x.value=!1,c.value=o.message||"Import failed")}catch(r){x.value=!1,c.value="Connection error. Please make sure the server is running.",console.error("Import error:",r)}finally{v.value=!1}}},M=()=>{window.location.href="/admin/dashboard"};return(r,e)=>(l(),s("div",L,[t("div",N,[t("div",{class:"mb-8"},[t("button",{onClick:M,class:"mb-4 text-slate-400 hover:text-slate-200 flex items-center gap-2 transition"},[...e[3]||(e[3]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),P(" Back to Dashboard ",-1)])]),e[4]||(e[4]=t("h1",{class:"text-3xl font-black bg-clip-text text-transparent bg-gradient-to-r from-white via-slate-100 to-slate-300"}," Import Staff Data ",-1)),e[5]||(e[5]=t("p",{class:"text-slate-400 mt-2"}," Upload CSV file to import multiple staff members at once ",-1))]),t("div",R,[e[10]||(e[10]=t("h2",{class:"text-lg font-bold text-slate-100 mb-4"}," Upload CSV File ",-1)),t("div",{class:S(["border-2 border-dashed border-slate-700 rounded-xl p-8 text-center hover:border-blue-500/50 transition-all cursor-pointer",{"border-blue-500 bg-blue-500/5":b.value}]),onClick:e[0]||(e[0]=o=>r.$refs.fileInput.click()),onDragover:e[1]||(e[1]=y(o=>b.value=!0,["prevent"])),onDragleave:e[2]||(e[2]=o=>b.value=!1),onDrop:y(F,["prevent"])},[t("input",{ref:"fileInput",type:"file",accept:".csv",onChange:B,class:"hidden"},null,544),a.value?u("",!0):(l(),s("svg",U,[...e[6]||(e[6]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"},null,-1)])])),a.value?(l(),s("div",H,[e[7]||(e[7]=t("div",{class:"w-16 h-16 mx-auto mb-4 bg-emerald-500/20 rounded-xl flex items-center justify-center"},[t("svg",{class:"w-8 h-8 text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1)),t("p",O,n(a.value.name),1),t("p",K,n(j(a.value.size))+" â€¢ "+n(i.value.length)+" rows detected ",1)])):(l(),s("div",q,[...e[8]||(e[8]=[t("p",{class:"text-slate-400 mb-2"}," Click to upload or drag and drop ",-1),t("p",{class:"text-xs text-slate-500"}," CSV files only (max 2MB) ",-1)])])),a.value?(l(),s("button",{key:3,onClick:y(V,["stop"]),class:"mt-4 px-4 py-2 text-sm bg-red-600/20 text-red-400 border border-red-600/30 rounded-lg hover:bg-red-600/30 transition"}," Remove File ")):u("",!0)],34),t("div",G,[e[9]||(e[9]=t("p",{class:"text-sm text-slate-400"},"Don't have a CSV file?",-1)),t("a",{href:`${T(D)}/api/staff/template`,download:"",class:"text-sm font-medium text-blue-400 hover:text-blue-300 underline"}," Download Template ",8,J)])]),i.value.length>0?(l(),s("div",Q,[t("h2",W," Preview ("+n(i.value.length)+" rows) ",1),t("div",X,[t("table",Y,[t("thead",Z,[t("tr",null,[(l(!0),s(k,null,w(p.value,o=>(l(),s("th",{key:o,class:"border border-slate-700 px-3 py-2 text-left text-xs font-semibold text-slate-300 uppercase"},n(o),1))),128))])]),t("tbody",null,[(l(!0),s(k,null,w(i.value.slice(0,5),(o,g)=>(l(),s("tr",{key:g,class:"hover:bg-slate-800/30"},[(l(!0),s(k,null,w(p.value,m=>(l(),s("td",{key:m,class:"border border-slate-700 px-3 py-2 text-slate-300"},n(o[m]||"-"),1))),128))]))),128))])])]),i.value.length>5?(l(),s("p",ee," Showing first 5 of "+n(i.value.length)+" rows ",1)):u("",!0)])):u("",!0),a.value?(l(),s("div",te,[t("button",{onClick:I,disabled:v.value,class:"flex-1 py-3 px-6 bg-gradient-to-r from-blue-600 to-emerald-500 text-white font-semibold rounded-xl hover:from-blue-500 hover:to-emerald-400 transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"},[v.value?(l(),s("span",le)):u("",!0),t("span",null,n(v.value?"Importing...":"Import Staff Data"),1)],8,se)])):u("",!0),c.value?(l(),s("div",{key:2,class:S(["mt-6 p-4 rounded-xl border",x.value?"bg-emerald-500/10 border-emerald-500/30 text-emerald-300":"bg-red-500/10 border-red-500/30 text-red-300"])},[t("p",re,n(c.value),1),h.value.length>0?(l(),s("div",oe,[e[11]||(e[11]=t("p",{class:"text-sm font-semibold mb-1"},"Errors:",-1)),t("ul",ae,[(l(!0),s(k,null,w(h.value,(o,g)=>(l(),s("li",{key:g}," â€¢ "+n(o),1))),128))])])):u("",!0)],2)):u("",!0)])]))}};z(ne).mount("#app");
