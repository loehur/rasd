import{r as l,j as f,c as u,o as i,p as g,a as s,d as b,t as p,w as h,e as c,v as m,h as x}from"./tailwind-jsiQPNE-.js";import{A as y}from"./api-n_PshMHp.js";import{_ as P}from"./AdminHeader-u0XL8aj-.js";const k={class:"min-h-screen bg-slate-950 text-slate-100"},C={class:"p-4 sm:p-6 lg:p-8"},N={class:"max-w-2xl mx-auto"},S={key:0,class:"mb-6 p-4 bg-emerald-500/10 border border-emerald-500/30 rounded-xl text-emerald-400"},A={key:1,class:"mb-6 p-4 bg-red-500/10 border border-red-500/30 rounded-xl text-red-400"},U={class:"bg-slate-900/70 backdrop-blur border border-slate-800/80 rounded-2xl p-6"},V={class:"mb-4"},E={class:"mb-4"},M={class:"mb-4"},T=["disabled"],B={__name:"ChangePasswordPage",setup(j){const w=l({name:"",phone_number:"",role:""}),v=l(!1),n=l(""),t=l(""),d=l(!1),o=l({current_password:"",new_password:"",confirm_password:""});f(()=>{const a=localStorage.getItem("auth_token"),e=localStorage.getItem("user");if(!a||!e){window.location.href="/admin";return}w.value=JSON.parse(e),document.addEventListener("click",r=>{r.target.closest(".relative")||(v.value=!1)})});const _=async()=>{if(n.value="",t.value="",o.value.new_password!==o.value.confirm_password){t.value="New passwords do not match";return}d.value=!0;try{const a=await fetch(`${y}/api/account/password`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({current_password:o.value.current_password,new_password:o.value.new_password,phone_number:w.value.phone_number})}),e=await a.json();a.ok&&e.success?(n.value="Password changed successfully!",o.value={current_password:"",new_password:"",confirm_password:""},setTimeout(()=>{n.value=""},3e3)):t.value=e.message||"Failed to change password"}catch(a){console.error("Change password error:",a),t.value="An error occurred: "+a.message}finally{d.value=!1}};return(a,e)=>(i(),u("div",k,[g(P,{title:"Change Password",subtitle:"Admin Portal"}),s("main",C,[s("div",N,[n.value?(i(),u("div",S,p(n.value),1)):b("",!0),t.value?(i(),u("div",A,p(t.value),1)):b("",!0),s("div",U,[s("form",{onSubmit:h(_,["prevent"])},[s("div",V,[e[3]||(e[3]=s("label",{class:"block text-sm font-medium text-slate-300 mb-2"}," Current Password ",-1)),c(s("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>o.value.current_password=r),type:"password",required:"",class:"w-full px-4 py-2 bg-slate-800/50 border border-slate-700 rounded-lg text-slate-100 placeholder-slate-500 focus:outline-none focus:border-blue-500 transition",placeholder:"Enter current password"},null,512),[[m,o.value.current_password]])]),s("div",E,[e[4]||(e[4]=s("label",{class:"block text-sm font-medium text-slate-300 mb-2"}," New Password ",-1)),c(s("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>o.value.new_password=r),type:"password",required:"",minlength:"6",class:"w-full px-4 py-2 bg-slate-800/50 border border-slate-700 rounded-lg text-slate-100 placeholder-slate-500 focus:outline-none focus:border-blue-500 transition",placeholder:"Enter new password (min 6 characters)"},null,512),[[m,o.value.new_password]])]),s("div",M,[e[5]||(e[5]=s("label",{class:"block text-sm font-medium text-slate-300 mb-2"}," Confirm New Password ",-1)),c(s("input",{"onUpdate:modelValue":e[2]||(e[2]=r=>o.value.confirm_password=r),type:"password",required:"",minlength:"6",class:"w-full px-4 py-2 bg-slate-800/50 border border-slate-700 rounded-lg text-slate-100 placeholder-slate-500 focus:outline-none focus:border-blue-500 transition",placeholder:"Confirm new password"},null,512),[[m,o.value.confirm_password]])]),s("button",{type:"submit",disabled:d.value,class:"w-full px-4 py-2 bg-emerald-600 hover:bg-emerald-700 disabled:bg-slate-700 text-white font-medium rounded-lg transition"},p(d.value?"Updating...":"Change Password"),9,T)],32)])])])]))}};x(B).mount("#app");
