import{r as i,c as s,o as l,a as e,e as u,h as D,w as C,n as b,t as a,u as P,F as _,k as y,b as T}from"./tailwind-DYKTCw70.js";import{A as M}from"./api-B5AYly-x.js";const N={class:"min-h-screen bg-slate-950 text-slate-100 p-6"},U={class:"max-w-4xl mx-auto"},H={class:"bg-slate-900/70 backdrop-blur border border-slate-800/80 rounded-2xl p-6 mb-6"},O={key:0,class:"w-16 h-16 mx-auto mb-4 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},K={key:1,class:"mb-4"},q={class:"text-lg font-semibold text-emerald-400"},G={class:"text-sm text-slate-400 mt-1"},J={key:2},Q={class:"mt-4 flex items-center justify-between"},W=["href"],X={key:0,class:"bg-slate-900/70 backdrop-blur border border-slate-800/80 rounded-2xl p-6 mb-6"},Y={class:"text-lg font-bold text-slate-100 mb-4"},Z={class:"overflow-x-auto"},ee={class:"w-full text-sm border-collapse border border-slate-700 rounded-lg"},te={class:"bg-slate-800/50"},se={key:0,class:"text-xs text-slate-500 mt-2"},le={key:1,class:"flex gap-4"},oe=["disabled"],re={key:0,class:"w-5 h-5 border-2 border-white/70 border-t-transparent rounded-full animate-spin"},ae={class:"flex items-start justify-between mb-3"},ne={class:"flex items-center gap-2"},de={key:0,class:"w-6 h-6 text-emerald-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ie={key:1,class:"w-6 h-6 text-red-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ue={key:0,class:"grid grid-cols-3 gap-3 mb-3"},pe={class:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-3"},ce={class:"text-2xl font-bold text-blue-300"},ve={class:"bg-purple-500/10 border border-purple-500/30 rounded-lg p-3"},me={class:"text-2xl font-bold text-purple-300"},xe={class:"bg-orange-500/10 border border-orange-500/30 rounded-lg p-3"},be={class:"text-2xl font-bold text-orange-300"},fe={key:1,class:"mt-3"},ge={class:"bg-slate-950/50 rounded-lg p-3 max-h-40 overflow-y-auto"},he={class:"text-xs space-y-1"},ke={__name:"ImportStaff",setup(we){const d=i(null),f=i([]),p=i([]),k=i(!1),g=i(!1),c=i(""),n=i(!1),m=i([]),v=i(null),j=r=>{const t=r.target.files[0];t&&t.type==="text/csv"?(d.value=t,S(t)):alert("Please select a valid CSV file")},F=r=>{k.value=!1;const t=r.dataTransfer.files[0];t&&t.type==="text/csv"&&(d.value=t,S(t))},S=r=>{const t=new FileReader;t.onload=o=>{const x=o.target.result.split(`
`).filter(h=>h.trim());x.length>0&&(f.value=x[0].split(",").map(h=>h.trim()),p.value=x.slice(1).map(h=>{const R=h.split(","),B={};return f.value.forEach(($,E)=>{B[$]=R[E]?.trim()||""}),B}))},t.readAsText(r)},I=()=>{d.value=null,f.value=[],p.value=[],c.value="",v.value=null},V=()=>{c.value="",n.value=!1,m.value=[],v.value=null},z=r=>r<1024?r+" B":r<1048576?(r/1024).toFixed(2)+" KB":(r/1048576).toFixed(2)+" MB",A=async()=>{if(d.value){g.value=!0,c.value="",m.value=[];try{const r=new FormData;r.append("file",d.value);const o=await(await fetch(`${M}/api/staff/import`,{method:"POST",headers:{Accept:"application/json"},body:r})).json();o.success?(n.value=!0,c.value=o.message,m.value=o.data?.errors||[],v.value={imported:o.data?.imported||0,updated:o.data?.updated||0,skipped:o.data?.skipped||0}):(n.value=!1,c.value=o.message||"Import failed",v.value=null)}catch(r){n.value=!1,c.value="Connection error. Please make sure the server is running.",console.error("Import error:",r)}finally{g.value=!1}}},L=()=>{window.location.href="/admin/dashboard"};return(r,t)=>(l(),s("div",N,[e("div",U,[e("div",{class:"mb-8"},[e("button",{onClick:L,class:"mb-4 text-slate-400 hover:text-slate-200 flex items-center gap-2 transition"},[...t[3]||(t[3]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),D(" Back to Dashboard ",-1)])]),t[4]||(t[4]=e("h1",{class:"text-3xl font-black bg-clip-text text-transparent bg-gradient-to-r from-white via-slate-100 to-slate-300"}," Import Staff Data ",-1)),t[5]||(t[5]=e("p",{class:"text-slate-400 mt-2"}," Upload CSV file to import multiple staff members at once ",-1))]),e("div",H,[t[10]||(t[10]=e("h2",{class:"text-lg font-bold text-slate-100 mb-4"}," Upload CSV File ",-1)),e("div",{class:b(["border-2 border-dashed border-slate-700 rounded-xl p-8 text-center hover:border-blue-500/50 transition-all cursor-pointer",{"border-blue-500 bg-blue-500/5":k.value}]),onClick:t[0]||(t[0]=o=>r.$refs.fileInput.click()),onDragover:t[1]||(t[1]=C(o=>k.value=!0,["prevent"])),onDragleave:t[2]||(t[2]=o=>k.value=!1),onDrop:C(F,["prevent"])},[e("input",{ref:"fileInput",type:"file",accept:".csv",onChange:j,class:"hidden"},null,544),d.value?u("",!0):(l(),s("svg",O,[...t[6]||(t[6]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"},null,-1)])])),d.value?(l(),s("div",K,[t[7]||(t[7]=e("div",{class:"w-16 h-16 mx-auto mb-4 bg-emerald-500/20 rounded-xl flex items-center justify-center"},[e("svg",{class:"w-8 h-8 text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1)),e("p",q,a(d.value.name),1),e("p",G,a(z(d.value.size))+" • "+a(p.value.length)+" rows detected ",1)])):(l(),s("div",J,[...t[8]||(t[8]=[e("p",{class:"text-slate-400 mb-2"}," Click to upload or drag and drop ",-1),e("p",{class:"text-xs text-slate-500"}," CSV files only (max 2MB) ",-1)])])),d.value?(l(),s("button",{key:3,onClick:C(I,["stop"]),class:"mt-4 px-4 py-2 text-sm bg-red-600/20 text-red-400 border border-red-600/30 rounded-lg hover:bg-red-600/30 transition"}," Remove File ")):u("",!0)],34),e("div",Q,[t[9]||(t[9]=e("p",{class:"text-sm text-slate-400"},"Don't have a CSV file?",-1)),e("a",{href:`${P(M)}/api/staff/template`,download:"",class:"text-sm font-medium text-blue-400 hover:text-blue-300 underline"}," Download Template ",8,W)])]),p.value.length>0?(l(),s("div",X,[e("h2",Y," Preview ("+a(p.value.length)+" rows) ",1),e("div",Z,[e("table",ee,[e("thead",te,[e("tr",null,[(l(!0),s(_,null,y(f.value,o=>(l(),s("th",{key:o,class:"border border-slate-700 px-3 py-2 text-left text-xs font-semibold text-slate-300 uppercase"},a(o),1))),128))])]),e("tbody",null,[(l(!0),s(_,null,y(p.value.slice(0,5),(o,w)=>(l(),s("tr",{key:w,class:"hover:bg-slate-800/30"},[(l(!0),s(_,null,y(f.value,x=>(l(),s("td",{key:x,class:"border border-slate-700 px-3 py-2 text-slate-300"},a(o[x]||"-"),1))),128))]))),128))])])]),p.value.length>5?(l(),s("p",se," Showing first 5 of "+a(p.value.length)+" rows ",1)):u("",!0)])):u("",!0),d.value?(l(),s("div",le,[e("button",{onClick:A,disabled:g.value,class:"flex-1 py-3 px-6 bg-gradient-to-r from-blue-600 to-emerald-500 text-white font-semibold rounded-xl hover:from-blue-500 hover:to-emerald-400 transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"},[g.value?(l(),s("span",re)):u("",!0),e("span",null,a(g.value?"Importing...":"Import Staff Data"),1)],8,oe)])):u("",!0),c.value?(l(),s("div",{key:2,class:b(["mt-6 p-6 rounded-xl border",n.value?"bg-emerald-500/10 border-emerald-500/30":"bg-red-500/10 border-red-500/30"])},[e("div",ae,[e("div",ne,[n.value?(l(),s("svg",de,[...t[11]||(t[11]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])])):(l(),s("svg",ie,[...t[12]||(t[12]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])])),e("p",{class:b(["font-bold text-lg",n.value?"text-emerald-300":"text-red-300"])},a(n.value?"Import Successful!":"Import Failed"),3)]),e("button",{onClick:V,class:"text-slate-400 hover:text-slate-200 transition"},[...t[13]||(t[13]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("p",{class:b(["mb-3",n.value?"text-emerald-200":"text-red-200"])},a(c.value),3),n.value&&v.value?(l(),s("div",ue,[e("div",pe,[t[14]||(t[14]=e("p",{class:"text-xs text-blue-300/70 mb-1"},"New Records",-1)),e("p",ce,a(v.value.imported),1)]),e("div",ve,[t[15]||(t[15]=e("p",{class:"text-xs text-purple-300/70 mb-1"}," Updated Records ",-1)),e("p",me,a(v.value.updated),1)]),e("div",xe,[t[16]||(t[16]=e("p",{class:"text-xs text-orange-300/70 mb-1"}," Skipped ",-1)),e("p",be,a(v.value.skipped),1)])])):u("",!0),m.value.length>0?(l(),s("div",fe,[e("p",{class:b(["text-sm font-semibold mb-2",n.value?"text-orange-300":"text-red-300"])},[t[17]||(t[17]=e("svg",{class:"w-4 h-4 inline mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1)),D(" Errors ("+a(m.value.length)+"): ",1)],2),e("div",ge,[e("ul",he,[(l(!0),s(_,null,y(m.value,(o,w)=>(l(),s("li",{key:w,class:b([n.value?"text-orange-200":"text-red-200"])}," • "+a(o),3))),128))])])])):u("",!0)],2)):u("",!0)])]))}};T(ke).mount("#app");
