import{r as p,i as u,j as G,c as l,o as i,a as t,d as P,g as S,n as j,t as o,F as c,l as b,e as W,v as $,w as R,h as H}from"./tailwind-Cyk5UPZk.js";import{A as O}from"./api-rG_fphBW.js";const U={class:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 p-6"},J={class:"max-w-7xl mx-auto"},K={class:"bg-white shadow-sm border border-indigo-100 rounded-xl p-4 mb-4"},q={class:"flex flex-wrap gap-2"},Q={class:"ml-1 text-xs opacity-70"},X=["onClick"],Y={class:"ml-1 text-xs opacity-70"},Z={class:"bg-white shadow-sm border border-indigo-100 rounded-xl p-4 mb-4"},tt={class:"flex gap-2"},et={key:0,class:"text-center py-12 bg-white shadow-sm border border-indigo-100 rounded-2xl"},st={key:1,class:"bg-red-50 border border-red-200 rounded-2xl p-6 text-center"},ot={class:"text-red-700 font-semibold"},rt={key:2,class:"bg-white shadow-sm border border-indigo-100 rounded-2xl overflow-hidden"},at={class:"hidden md:block overflow-x-auto"},nt={class:"w-full text-xs"},lt={class:"bg-gradient-to-r from-purple-50 to-indigo-50"},it={colspan:"12",class:"px-3 py-3 text-left font-bold text-purple-700 text-sm"},dt={class:"px-3 py-2 text-indigo-600 font-bold"},pt={class:"px-3 py-2"},ut={class:"px-3 py-2"},xt={class:"px-3 py-2 text-indigo-600 font-mono font-semibold"},ct={class:"px-3 py-2"},gt={class:"px-3 py-2"},mt={class:"px-3 py-2"},vt={class:"px-3 py-2"},bt={class:"px-3 py-2"},yt={class:"px-3 py-2"},ft={class:"px-3 py-2"},ht={class:"px-3 py-2"},_t={class:"md:hidden"},kt={class:"bg-gradient-to-r from-purple-50 to-indigo-50 px-4 py-3 border-t border-indigo-100"},wt={class:"font-bold text-purple-700 text-sm"},Ct={class:"divide-y divide-gray-200"},Lt=["onClick"],St={class:"flex items-start gap-3 mb-3"},jt={class:"flex items-center gap-2"},Mt={class:"text-indigo-600 font-bold text-sm"},Bt={class:"w-12 h-12 rounded-full bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center text-white font-bold text-sm flex-shrink-0"},At={class:"flex-1 min-w-0"},Dt={class:"text-sm font-semibold text-gray-900 truncate"},Pt={class:"text-xs text-gray-600 truncate"},Nt={class:"text-xs font-mono text-indigo-600 mt-1 font-semibold"},Vt={key:0,class:"px-2 py-1 text-xs font-medium rounded-full bg-red-100 text-red-700 border border-red-300"},It={key:1,class:"px-2 py-1 text-xs font-medium rounded-full bg-orange-100 text-orange-700 border border-orange-300"},Tt={key:2,class:"px-2 py-1 text-xs font-medium rounded-full bg-emerald-100 text-emerald-700 border border-emerald-300"},zt={class:"grid grid-cols-2 gap-2 text-xs"},Et={class:"text-gray-700 font-medium truncate"},Ft={class:"text-gray-700 font-medium truncate"},Gt={key:3,class:"text-center py-12 bg-white shadow-sm border border-indigo-100 rounded-2xl"},Wt={class:"flex items-start justify-between mb-6"},$t={class:"flex items-center gap-4"},Rt={class:"w-16 h-16 rounded-full bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center text-white text-2xl font-bold"},Ht={class:"text-2xl font-bold text-gray-900"},Ot={class:"text-gray-600"},Ut={class:"grid grid-cols-2 gap-4"},Jt={class:"text-sm text-gray-900 font-mono"},Kt={class:"text-sm text-gray-900"},qt={class:"text-sm text-gray-900"},Qt={class:"text-sm text-gray-900"},Xt={class:"text-sm text-gray-900"},Yt={class:"text-sm text-gray-900"},Zt={class:"text-sm text-gray-900"},te={class:"text-sm text-gray-900"},ee={class:"text-sm text-gray-900"},se={class:"text-sm text-gray-900"},oe={class:"text-sm text-gray-900"},re={class:"text-sm text-gray-900"},ae={class:"text-sm text-gray-900"},ne={key:0,class:"col-span-2"},le={class:"text-sm text-gray-900"},ie={__name:"TeamLeaderStaffList",setup(de){const f=p([]),h=p(!1),m=p(""),v=p(""),_=p(""),k=p(""),x=p(""),w=p(1),C=p(5),n=p(null),N=["P-1","P","A1-1","A1-2","A1-3","A2","B1","B2","M2"],g=u(()=>f.value.filter(s=>s.staff_status==="active"||!s.staff_status)),M=async()=>{h.value=!0,m.value="";try{if(!localStorage.getItem("tl_auth_token")){window.location.href="/";return}const r=await(await fetch(`${O}/api/staff`,{method:"GET",headers:{Accept:"application/json"}})).json();r.success?f.value=r.data||[]:m.value="Failed to load staff data"}catch(s){m.value="Connection error. Please make sure you're logged in.",console.error("Load error:",s)}finally{h.value=!1}},y=u(()=>{let s=g.value;if(x.value&&(s=s.filter(e=>e.group===x.value)),v.value){const e=v.value.toLowerCase();s=s.filter(r=>r.name.toLowerCase().includes(e)||r.staff_id.toLowerCase().includes(e)||r.phone_number.includes(e))}return _.value&&(s=s.filter(e=>e.department===_.value)),k.value&&(s=s.filter(e=>e.position===k.value)),s}),B=u(()=>{const s={};return y.value.forEach(e=>{const r=A(e)||"No Team Leader";s[r]||(s[r]=[]),s[r].push(e)}),s});u(()=>[...new Set(g.value.map(s=>s.department))].filter(Boolean)),u(()=>[...new Set(g.value.map(s=>s.position))].filter(Boolean));const V=u(()=>{const s={};return f.value.forEach(e=>{s[e.staff_id]=e.name}),s}),A=s=>{const e=s?.team_leader_id||"";return e&&V.value[e]||"-"};u(()=>g.value.reduce((s,e)=>s+(e.ojk_case||0),0));const I=u(()=>Math.ceil(y.value.length/C.value));u(()=>{const s=(w.value-1)*C.value,e=s+C.value;return y.value.slice(s,e)}),u(()=>{const s=[];let r=Math.max(1,w.value-Math.floor(2.5)),d=Math.min(I.value,r+5-1);d-r<4&&(r=Math.max(1,d-5+1));for(let a=r;a<=d;a++)s.push(a);return s});const D=s=>s.split(" ").map(e=>e[0]).join("").toUpperCase().substring(0,2),T=s=>g.value.filter(e=>e.group===s).length,z=s=>{n.value=s},E=()=>{window.location.href="/team-leader/dashboard"},F=()=>{v.value="",_.value="",k.value="",x.value="",w.value=1};return G(()=>{if(!localStorage.getItem("tl_auth_token")){window.location.href="/";return}M()}),(s,e)=>(i(),l("div",U,[t("div",J,[t("div",{class:"mb-8"},[t("button",{onClick:E,class:"mb-4 text-indigo-600 hover:text-indigo-800 flex items-center gap-2 transition"},[...e[5]||(e[5]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),S(" Back to Dashboard ",-1)])]),e[6]||(e[6]=t("div",{class:"flex items-center justify-between"},[t("div",null,[t("h1",{class:"text-3xl font-black bg-clip-text text-transparent bg-gradient-to-r from-green-600 via-emerald-600 to-green-700"}," Active Staff "),t("p",{class:"text-sm text-gray-600 mt-1"}," Staff members who are currently active ")])],-1))]),t("div",K,[e[8]||(e[8]=t("div",{class:"flex items-center gap-2 mb-3"},[t("svg",{class:"w-5 h-5 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})]),t("span",{class:"text-sm font-medium text-gray-700"},"Filter by Group:")],-1)),t("div",q,[t("button",{onClick:e[0]||(e[0]=r=>x.value=""),class:j(["px-4 py-2 text-sm font-medium rounded-lg transition",x.value===""?"bg-green-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"])},[e[7]||(e[7]=S(" All ",-1)),t("span",Q,"("+o(g.value.length)+")",1)],2),(i(),l(c,null,b(N,r=>t("button",{key:r,onClick:d=>x.value=r,class:j(["px-4 py-2 text-sm font-medium rounded-lg transition",x.value===r?"bg-purple-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"])},[S(o(r)+" ",1),t("span",Y,"("+o(T(r))+")",1)],10,X)),64))])]),t("div",Z,[t("div",tt,[W(t("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>v.value=r),type:"text",placeholder:"Search by name, staff ID, or phone...",class:"flex-1 px-3 py-2 text-sm bg-gray-50 border border-gray-300 rounded-lg text-gray-900 placeholder-gray-500 focus:outline-none focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 transition"},null,512),[[$,v.value]]),t("button",{onClick:F,class:"px-3 py-2 text-sm bg-gray-100 border border-gray-300 rounded-lg text-gray-600 hover:text-gray-900 hover:bg-gray-200 transition flex items-center justify-center",title:"Reset search"},[...e[9]||(e[9]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),h.value?(i(),l("div",et,[...e[10]||(e[10]=[t("div",{class:"inline-block w-12 h-12 border-4 border-indigo-200 border-t-indigo-600 rounded-full animate-spin"},null,-1),t("p",{class:"text-gray-600 mt-4"},"Loading staff data...",-1)])])):m.value?(i(),l("div",st,[e[11]||(e[11]=t("svg",{class:"w-12 h-12 text-red-500 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t("p",ot,o(m.value),1),t("button",{onClick:M,class:"mt-4 px-4 py-2 bg-red-100 text-red-700 border border-red-300 rounded-lg hover:bg-red-200 transition"}," Retry ")])):y.value.length>0?(i(),l("div",rt,[t("div",at,[t("table",nt,[e[12]||(e[12]=t("thead",{class:"bg-gradient-to-r from-indigo-50 to-purple-50"},[t("tr",null,[t("th",{class:"px-3 py-2 text-left text-[11px] font-semibold text-gray-700 uppercase tracking-wider"}," SN "),t("th",{class:"px-3 py-2 text-left text-[11px] font-semibold text-gray-700 uppercase tracking-wider"}," Area "),t("th",{class:"px-3 py-2 text-left text-[11px] font-semibold text-gray-700 uppercase tracking-wider"}," WFH/Onsite "),t("th",{class:"px-3 py-2 text-left text-[11px] font-semibold text-gray-700 uppercase tracking-wider"}," ID Staff "),t("th",{class:"px-3 py-2 text-left text-[11px] font-semibold text-gray-700 uppercase tracking-wider"}," Name Staff "),t("th",{class:"px-3 py-2 text-left text-[11px] font-semibold text-gray-700 uppercase tracking-wider"}," Position "),t("th",{class:"px-3 py-2 text-left text-[11px] font-semibold text-gray-700 uppercase tracking-wider"}," Superior "),t("th",{class:"px-3 py-2 text-left text-[11px] font-semibold text-gray-700 uppercase tracking-wider"}," Department "),t("th",{class:"px-3 py-2 text-left text-[11px] font-semibold text-gray-700 uppercase tracking-wider"}," Hiredate "),t("th",{class:"px-3 py-2 text-left text-[11px] font-semibold text-gray-700 uppercase tracking-wider"}," Rank "),t("th",{class:"px-3 py-2 text-left text-[11px] font-semibold text-gray-700 uppercase tracking-wider"}," Device "),t("th",{class:"px-3 py-2 text-left text-[11px] font-semibold text-gray-700 uppercase tracking-wider"}," WL ")])],-1)),t("tbody",null,[(i(!0),l(c,null,b(B.value,(r,d)=>(i(),l(c,{key:d},[t("tr",lt,[t("td",it," Team Leader: "+o(d),1)]),(i(!0),l(c,null,b(r,(a,L)=>(i(),l("tr",{key:a.id,class:"hover:bg-indigo-50/50 transition border-t border-gray-200"},[t("td",dt,o(L+1),1),t("td",pt,o(a.area||"-"),1),t("td",ut,o(a.work_location||"-"),1),t("td",xt,o(a.staff_id),1),t("td",ct,o(a.name),1),t("td",gt,o(a.position||"-"),1),t("td",mt,o(A(a)),1),t("td",vt,o(a.department||"-"),1),t("td",bt,o(a.hire_date),1),t("td",yt,o(a.rank||"-"),1),t("td",ft,o(a.device||"-"),1),t("td",ht,o(a.warning_letter?"WL":"-"),1)]))),128))],64))),128))])])]),t("div",_t,[(i(!0),l(c,null,b(B.value,(r,d)=>(i(),l(c,{key:d},[t("div",kt,[t("h3",wt," Team Leader: "+o(d),1)]),t("div",Ct,[(i(!0),l(c,null,b(r,(a,L)=>(i(),l("div",{key:a.id,onClick:pe=>z(a),class:"p-4 hover:bg-indigo-50/50 transition cursor-pointer"},[t("div",St,[t("div",jt,[t("span",Mt,o(L+1)+".",1),t("div",Bt,o(D(a.name)),1)]),t("div",At,[t("h3",Dt,o(a.name),1),t("p",Pt,o(a.position),1),t("p",Nt,o(a.staff_id),1)]),t("div",null,[a.ojk_case>0?(i(),l("span",Vt," OJK ")):a.warning_letter?(i(),l("span",It," Warning ")):(i(),l("span",Tt," Active "))])]),t("div",zt,[t("div",null,[e[13]||(e[13]=t("p",{class:"text-gray-500"},"Department",-1)),t("p",Et,o(a.department),1)]),t("div",null,[e[14]||(e[14]=t("p",{class:"text-gray-500"},"Phone",-1)),t("p",Ft,o(a.phone_number),1)])])],8,Lt))),128))])],64))),128))])])):(i(),l("div",Gt,[...e[15]||(e[15]=[t("svg",{class:"w-16 h-16 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})],-1),t("p",{class:"text-gray-600 text-lg"},"No staff found",-1)])])),n.value?(i(),l("div",{key:4,onClick:e[4]||(e[4]=r=>n.value=null),class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50"},[t("div",{onClick:e[3]||(e[3]=R(()=>{},["stop"])),class:"bg-white border border-indigo-100 rounded-2xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-xl"},[t("div",Wt,[t("div",$t,[t("div",Rt,o(D(n.value.name)),1),t("div",null,[t("h2",Ht,o(n.value.name),1),t("p",Ot,o(n.value.position),1)])]),t("button",{onClick:e[2]||(e[2]=r=>n.value=null),class:"text-gray-400 hover:text-gray-700 transition"},[...e[16]||(e[16]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",Ut,[t("div",null,[e[17]||(e[17]=t("p",{class:"text-xs text-gray-500 uppercase mb-1"}," Staff ID ",-1)),t("p",Jt,o(n.value.staff_id),1)]),t("div",null,[e[18]||(e[18]=t("p",{class:"text-xs text-gray-500 uppercase mb-1"}," Department ",-1)),t("p",Kt,o(n.value.department),1)]),t("div",null,[e[19]||(e[19]=t("p",{class:"text-xs text-gray-500 uppercase mb-1"}," Phone Number ",-1)),t("p",qt,o(n.value.phone_number),1)]),t("div",null,[e[20]||(e[20]=t("p",{class:"text-xs text-gray-500 uppercase mb-1"}," Email ",-1)),t("p",Qt,o(n.value.email||"-"),1)]),t("div",null,[e[21]||(e[21]=t("p",{class:"text-xs text-gray-500 uppercase mb-1"}," Superior ",-1)),t("p",Xt,o(n.value.superior||"-"),1)]),t("div",null,[e[22]||(e[22]=t("p",{class:"text-xs text-gray-500 uppercase mb-1"}," Group ",-1)),t("p",Yt,o(n.value.group||"-"),1)]),t("div",null,[e[23]||(e[23]=t("p",{class:"text-xs text-gray-500 uppercase mb-1"}," Area ",-1)),t("p",Zt,o(n.value.area||"-"),1)]),t("div",null,[e[24]||(e[24]=t("p",{class:"text-xs text-gray-500 uppercase mb-1"}," Work Location ",-1)),t("p",te,o(n.value.work_location||"-"),1)]),t("div",null,[e[25]||(e[25]=t("p",{class:"text-xs text-gray-500 uppercase mb-1"}," Hire Date ",-1)),t("p",ee,o(n.value.hire_date),1)]),t("div",null,[e[26]||(e[26]=t("p",{class:"text-xs text-gray-500 uppercase mb-1"}," Rank ",-1)),t("p",se,o(n.value.rank||"-"),1)]),t("div",null,[e[27]||(e[27]=t("p",{class:"text-xs text-gray-500 uppercase mb-1"}," Device ",-1)),t("p",oe,o(n.value.device||"-"),1)]),t("div",null,[e[28]||(e[28]=t("p",{class:"text-xs text-gray-500 uppercase mb-1"}," Team Leader ID ",-1)),t("p",re,o(n.value.team_leader_id||"-"),1)]),t("div",null,[e[29]||(e[29]=t("p",{class:"text-xs text-gray-500 uppercase mb-1"}," Warning Letter ",-1)),t("p",ae,o(n.value.warning_letter||"-"),1)]),t("div",null,[e[30]||(e[30]=t("p",{class:"text-xs text-gray-500 uppercase mb-1"}," OJK Case ",-1)),t("p",{class:j(["text-sm font-semibold",n.value.ojk_case>0?"text-red-600":"text-emerald-600"])},o(n.value.ojk_case),3)]),n.value.notes?(i(),l("div",ne,[e[31]||(e[31]=t("p",{class:"text-xs text-gray-500 uppercase mb-1"}," Notes ",-1)),t("p",le,o(n.value.notes),1)])):P("",!0)])])])):P("",!0)])]))}};H(ie).mount("#app");
