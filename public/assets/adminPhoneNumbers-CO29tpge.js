import{r as u,j as T,c as a,o as l,p as V,a as e,d as p,b as F,t as n,e as S,v as P,F as L,l as U,g as N,w as R,n as q,h as J}from"./tailwind-Cyk5UPZk.js";import{_ as O}from"./AdminHeader-orjVGE2-.js";import{A as C}from"./api-rG_fphBW.js";const Q={class:"min-h-screen bg-slate-950 text-slate-100"},Y={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},G={class:"bg-slate-900/70 backdrop-blur border border-slate-800/80 rounded-xl shadow-sm"},H={class:"px-6 py-4 border-b border-slate-800/80"},K={class:"flex items-center justify-between"},W={class:"text-sm text-slate-500"},X={class:"mt-4"},Z={class:"flex gap-3"},ee={class:"flex-1"},te={key:0,class:"mt-1 text-sm text-red-400"},se=["disabled"],oe={key:0,class:"p-8 text-center"},ae={key:1,class:"p-8 text-center text-red-400"},le={key:2,class:"overflow-x-auto"},re={class:"w-full"},ne={class:"bg-slate-800/50"},ie={key:0,class:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider"},de={class:"divide-y divide-slate-800/80"},ue={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-slate-200"},ce={class:"px-6 py-4 whitespace-nowrap text-sm text-slate-300"},pe={class:"px-6 py-4 whitespace-nowrap text-sm text-slate-400"},me={class:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-emerald-400"},he={class:"px-6 py-4 whitespace-nowrap text-sm text-slate-400"},xe={key:0,class:"relative group"},be={class:"absolute z-50 invisible group-hover:visible bg-slate-800 border border-slate-600 text-slate-200 text-xs rounded-lg py-2 px-3 bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-48 max-w-xs shadow-xl"},ve={key:1,class:"text-slate-500"},ge={class:"px-6 py-4 whitespace-nowrap text-sm text-slate-500"},fe={key:0,class:"px-6 py-4 whitespace-nowrap text-sm"},_e={class:"flex gap-2"},ye=["onClick"],we=["onClick"],ke={key:3,class:"p-8 text-center text-slate-500"},Se={key:4,class:"px-6 py-4 border-t border-slate-800/80 flex items-center justify-between"},Pe={class:"text-sm text-slate-400"},Ne={class:"flex gap-2"},Ce=["disabled"],Ae=["disabled"],je={key:0,class:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50"},Ee={class:"bg-slate-900 border border-slate-700 rounded-xl shadow-2xl p-6 max-w-md w-full mx-4"},Me={class:"flex gap-3 justify-end mt-6"},$e=["disabled"],ze={class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},De={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},Be={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},Ie={__name:"AdminPhoneNumbersApp",setup(Te){const _=u([]),b=u(!0),v=u(""),y=u(!1),m=u({show:!1,message:"",type:"success"}),i=u(""),h=u(""),w=u(!1),d=u({id:null,phone_number:"",remarks:""}),k=u(!1),r=u({current_page:1,per_page:20,total:0,total_pages:0,has_prev:!1,has_next:!1});T(()=>{const o=localStorage.getItem("user");if(o)try{const t=JSON.parse(o);k.value=["super-admin","admin"].includes(t.role)}catch{}x()});const x=async(o=1)=>{b.value=!0,v.value="";try{const t=localStorage.getItem("auth_token"),s=new URLSearchParams;s.append("page",o),s.append("per_page",20),i.value&&i.value.length>=8&&s.append("search",i.value);const f=await(await fetch(`${C}/api/phone-numbers?${s.toString()}`,{headers:{Authorization:`Bearer ${t}`,Accept:"application/json"}})).json();f.success?(_.value=f.data,f.pagination&&(r.value=f.pagination)):v.value=f.message||"Failed to fetch phone numbers"}catch(t){v.value="Failed to connect to server",console.error("Error:",t)}finally{b.value=!1}},A=o=>{o>=1&&o<=r.value.total_pages&&x(o)},E=()=>{h.value="",i.value.length>0&&i.value.length<8&&(h.value="Please enter at least 8 digits")},M=async()=>{if(i.value.length>0&&i.value.length<8){h.value="Please enter at least 8 digits";return}x()},$=()=>{i.value="",h.value="",x()},z=o=>{d.value={id:o.id,phone_number:o.phone_number,remarks:o.remarks},w.value=!0},D=async()=>{if(!d.value.phone_number.trim()){c("Please enter a phone number","error");return}if(!d.value.remarks.trim()){c("Please enter remarks","error");return}y.value=!0;try{const o=localStorage.getItem("auth_token"),s=await(await fetch(`${C}/api/phone-numbers/${d.value.id}`,{method:"PUT",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({phone_number:d.value.phone_number,remarks:d.value.remarks})})).json();s.success?(c("Phone number updated successfully!","success"),j(),x()):c(s.message||"Failed to update phone number","error")}catch(o){c("Failed to connect to server","error"),console.error("Error:",o)}finally{y.value=!1}},j=()=>{w.value=!1,d.value={id:null,phone_number:"",remarks:""}},B=async o=>{if(confirm("Are you sure you want to delete this phone number?"))try{const t=localStorage.getItem("auth_token"),g=await(await fetch(`${C}/api/phone-numbers/${o}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`,Accept:"application/json"}})).json();g.success?(c("Phone number deleted successfully","success"),x()):c(g.message||"Failed to delete phone number","error")}catch(t){c("Failed to connect to server","error"),console.error("Error:",t)}},I=o=>o?new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-",c=(o,t="success")=>{m.value={show:!0,message:o,type:t},setTimeout(()=>{m.value.show=!1},3e3)};return(o,t)=>(l(),a("div",Q,[V(O,{title:"Phone Numbers",subtitle:"Manage Contact Information"}),e("main",Y,[t[15]||(t[15]=F('<div class="mb-6"><h1 class="text-2xl font-bold text-slate-100">Phone Numbers Management</h1><p class="text-sm text-slate-400 mt-1">View, edit, and manage phone numbers from all staff</p></div><div class="mb-6 bg-blue-900/20 border border-blue-800/50 rounded-lg p-4"><div class="flex items-start gap-3"><svg class="w-5 h-5 text-blue-400 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><p class="text-sm text-blue-200"> As admin, you can view all phone numbers from all staff. You can edit and delete entries, but cannot add new ones (staff add their own data). </p></div></div>',2)),e("div",G,[e("div",H,[e("div",K,[t[5]||(t[5]=e("h2",{class:"text-lg font-bold text-slate-100"},"Phone Numbers List",-1)),e("div",W," Showing "+n(r.value.total>0?(r.value.current_page-1)*r.value.per_page+1:0)+" - "+n(Math.min(r.value.current_page*r.value.per_page,r.value.total))+" of "+n(r.value.total)+" entries ",1)]),e("div",X,[e("div",Z,[e("div",ee,[S(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>i.value=s),type:"text",placeholder:"Search phone number (min. 8 digits)",class:"w-full px-4 py-2 bg-slate-950 border border-slate-700 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-slate-100 placeholder-slate-500",onInput:E},null,544),[[P,i.value]]),h.value?(l(),a("p",te,n(h.value),1)):p("",!0)]),e("button",{onClick:M,disabled:i.value.length>0&&i.value.length<8,class:"px-6 py-2 bg-indigo-600 text-white font-semibold rounded-lg hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"}," Search ",8,se),i.value?(l(),a("button",{key:0,onClick:$,class:"px-6 py-2 bg-slate-700 text-slate-200 font-semibold rounded-lg hover:bg-slate-600 transition-colors"}," Clear ")):p("",!0)])])]),b.value?(l(),a("div",oe,[...t[6]||(t[6]=[e("div",{class:"inline-block h-8 w-8 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"},null,-1),e("p",{class:"mt-2 text-slate-400"},"Loading...",-1)])])):v.value?(l(),a("div",ae,n(v.value),1)):_.value.length>0?(l(),a("div",le,[e("table",re,[e("thead",ne,[e("tr",null,[t[7]||(t[7]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider"}," Employee ID ",-1)),t[8]||(t[8]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider"}," Employee Name ",-1)),t[9]||(t[9]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider"}," Team Leader ",-1)),t[10]||(t[10]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider"}," Phone Number ",-1)),t[11]||(t[11]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider"}," Remarks ",-1)),t[12]||(t[12]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider"}," Date Added ",-1)),k.value?(l(),a("th",ie," Actions ")):p("",!0)])]),e("tbody",de,[(l(!0),a(L,null,U(_.value,s=>(l(),a("tr",{key:s.id,class:"hover:bg-slate-800/30 transition-colors"},[e("td",ue,n(s.staff_id),1),e("td",ce,n(s.employee_name),1),e("td",pe,n(s.team_leader_name||"-"),1),e("td",me,n(s.phone_number),1),e("td",he,[s.remarks?(l(),a("div",xe,[t[14]||(t[14]=e("svg",{class:"w-5 h-5 text-amber-400 cursor-help",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("div",be,[N(n(s.remarks)+" ",1),t[13]||(t[13]=e("div",{class:"absolute top-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-t-slate-600"},null,-1))])])):(l(),a("span",ve,"-"))]),e("td",ge,n(I(s.created_at)),1),k.value?(l(),a("td",fe,[e("div",_e,[e("button",{onClick:g=>z(s),class:"text-indigo-400 hover:text-indigo-300 font-medium transition-colors"}," Edit ",8,ye),e("button",{onClick:g=>B(s.id),class:"text-rose-400 hover:text-rose-300 font-medium transition-colors"}," Delete ",8,we)])])):p("",!0)]))),128))])])])):(l(),a("div",ke," No phone numbers found. ")),_.value.length>0?(l(),a("div",Se,[e("div",Pe," Page "+n(r.value.current_page)+" of "+n(r.value.total_pages),1),e("div",Ne,[e("button",{onClick:t[1]||(t[1]=s=>A(r.value.current_page-1)),disabled:!r.value.has_prev||b.value,class:"px-4 py-2 bg-slate-700 text-slate-200 font-medium rounded-lg hover:bg-slate-600 disabled:opacity-40 disabled:cursor-not-allowed transition-colors"}," ← Previous ",8,Ce),e("button",{onClick:t[2]||(t[2]=s=>A(r.value.current_page+1)),disabled:!r.value.has_next||b.value,class:"px-4 py-2 bg-slate-700 text-slate-200 font-medium rounded-lg hover:bg-slate-600 disabled:opacity-40 disabled:cursor-not-allowed transition-colors"}," Next → ",8,Ae)])])):p("",!0)])]),w.value?(l(),a("div",je,[e("div",Ee,[t[18]||(t[18]=e("h3",{class:"text-xl font-bold text-slate-100 mb-4"},"Edit Phone Number",-1)),e("form",{onSubmit:R(D,["prevent"]),class:"space-y-4"},[e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-slate-300 mb-2"},[N(" Phone Number "),e("span",{class:"text-rose-500"},"*")],-1)),S(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>d.value.phone_number=s),type:"tel",required:"",class:"w-full px-4 py-2 bg-slate-950 border border-slate-700 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-slate-100 placeholder-slate-500"},null,512),[[P,d.value.phone_number]])]),e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-slate-300 mb-2"},[N(" Remarks "),e("span",{class:"text-rose-500"},"*")],-1)),S(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>d.value.remarks=s),type:"text",required:"",class:"w-full px-4 py-2 bg-slate-950 border border-slate-700 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-slate-100 placeholder-slate-500"},null,512),[[P,d.value.remarks]])]),e("div",Me,[e("button",{type:"button",onClick:j,class:"px-4 py-2 border border-slate-600 text-slate-300 rounded-lg hover:bg-slate-800 transition-colors"}," Cancel "),e("button",{type:"submit",disabled:y.value,class:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-500 disabled:opacity-50 transition-colors"},n(y.value?"Saving...":"Save Changes"),9,$e)])],32)])])):p("",!0),m.value.show?(l(),a("div",{key:1,class:q(["fixed top-4 right-4 px-6 py-4 rounded-lg shadow-lg z-50 flex items-center space-x-3",m.value.type==="success"?"bg-emerald-600":"bg-rose-600","text-white"])},[(l(),a("svg",ze,[m.value.type==="success"?(l(),a("path",De)):(l(),a("path",Be))])),e("span",null,n(m.value.message),1)],2)):p("",!0)]))}};J(Ie).mount("#app");
