import{r as c,i as D,j as M,c as l,o as n,a as t,g as y,n as m,t as a,F as h,l as k,e as R,v as I,h as $}from"./tailwind-N4FRguTo.js";import{A as w}from"./api-n_PshMHp.js";const F={class:"min-h-screen bg-slate-950 text-slate-100 p-6"},Y={class:"max-w-7xl mx-auto"},V={class:"bg-slate-900/70 backdrop-blur border border-slate-800/80 rounded-xl p-4 mb-4"},z={class:"flex flex-wrap gap-2"},N={class:"ml-1 text-xs opacity-70"},T=["onClick"],E={class:"ml-1 text-xs opacity-70"},P={class:"bg-slate-900/70 backdrop-blur border border-slate-800/80 rounded-xl p-4 mb-4"},U={class:"flex gap-2"},H={key:0,class:"text-center py-12 bg-slate-900/70 backdrop-blur border border-slate-800/80 rounded-2xl"},W={key:1,class:"bg-red-500/10 border border-red-500/30 rounded-2xl p-6 text-center"},q={class:"text-red-300 font-semibold"},G={key:2,class:"bg-slate-900/70 backdrop-blur border border-slate-800/80 rounded-2xl overflow-hidden"},J={class:"hidden md:block overflow-x-auto"},O={class:"w-full text-xs"},Q={class:"px-3 py-2 text-slate-300 font-semibold"},X={class:"px-3 py-2 text-blue-300 font-mono font-semibold"},K={class:"px-3 py-2"},Z={class:"px-3 py-2"},tt={class:"px-3 py-2"},et={class:"px-3 py-2"},st={class:"px-3 py-2"},ot=["title"],at={class:"md:hidden divide-y divide-slate-800/50"},rt={class:"flex items-start justify-between mb-3"},lt={class:"flex-1 min-w-0"},nt={class:"text-sm font-semibold text-slate-100"},dt={class:"text-xs font-mono text-blue-300 mt-1"},it={class:"grid grid-cols-2 gap-2 text-xs"},ut={class:"text-slate-300 font-medium"},ct={class:"text-slate-300 font-medium"},pt={class:"text-slate-300 font-medium truncate"},xt={class:"text-slate-300 font-medium truncate"},bt={class:"col-span-2"},ft={class:"text-slate-300 text-xs mt-1 line-clamp-2"},mt={key:3,class:"text-center py-12 bg-slate-900/70 backdrop-blur border border-slate-800/80 rounded-2xl"},vt={__name:"InactiveStaffList",setup(gt){const p=c([]),v=c(!1),x=c(""),g=c(""),b=c(""),u=c(new Date().getFullYear()),C=D(()=>{const o=p.value.map(e=>new Date(e.report_day).getFullYear());return[...new Set(o)].sort((e,s)=>s-e)}),S=async()=>{v.value=!0,x.value="";try{const o=localStorage.getItem("auth_token")||localStorage.getItem("tl_auth_token");if(!o){window.location.href="/admin";return}const e=[`${w}/api/resignations?per_page=1000`,`${w}/api/admin/resignations?per_page=1000`,`${w}/api/resignations`];let s=[];for(const d of e)try{const i=await fetch(d,{method:"GET",headers:{Authorization:`Bearer ${o}`,Accept:"application/json","X-Role":JSON.parse(localStorage.getItem("user")||"{}").role||"admin"}});let r;try{r=await i.json()}catch{const B=await i.text();g.value=`Status: ${i.status} ${i.statusText}
URL: ${d}
Response: ${B.substring(0,500)}`;continue}if(r&&r.success===!0?s=Array.isArray(r.data)?r.data:r.results||[]:Array.isArray(r)?s=r:r&&Array.isArray(r.data)&&(s=r.data),s.length)break}catch(i){g.value=String(i?.message||i)}s.length?p.value=s.filter(d=>d&&(d.report_day||d.last_working_day)).sort((d,i)=>new Date(i.report_day||i.last_working_day)-new Date(d.report_day||d.last_working_day)):x.value="Failed to load resignation data"}catch(o){x.value="Connection error. Please make sure you're logged in.",console.error("Load error:",o),g.value=String(o?.message||o)}finally{v.value=!1}},_=D(()=>{let o=p.value;if(u.value&&(o=o.filter(e=>new Date(e.report_day).getFullYear()===u.value)),b.value){const e=b.value.toLowerCase();o=o.filter(s=>(s.staff_name||"").toLowerCase().includes(e)||(s.staff_id||"").toLowerCase().includes(e)||(s.reason||"").toLowerCase().includes(e))}return o}),L=o=>p.value.filter(e=>new Date(e.report_day).getFullYear()===o).length,f=o=>o?new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"-",A=()=>{window.location.href="/admin/dashboard"},j=()=>{b.value="",u.value=""};return M(()=>{if(!localStorage.getItem("auth_token")){window.location.href="/admin";return}S()}),(o,e)=>(n(),l("div",F,[t("div",Y,[t("div",{class:"mb-8"},[t("button",{onClick:A,class:"mb-4 text-slate-400 hover:text-slate-200 flex items-center gap-2 transition"},[...e[2]||(e[2]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),y(" Back to Dashboard ",-1)])]),e[3]||(e[3]=t("div",{class:"flex items-center justify-between"},[t("div",null,[t("h1",{class:"text-3xl font-black bg-clip-text text-transparent bg-gradient-to-r from-slate-100 via-slate-200 to-slate-300"}," Inactive Staff "),t("p",{class:"text-slate-400 mt-2"}," Staff members who are no longer active ")])],-1))]),t("div",V,[e[5]||(e[5]=t("div",{class:"flex items-center gap-2 mb-3"},[t("svg",{class:"w-5 h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})]),t("span",{class:"text-sm font-medium text-slate-300"},"Filter by Year:")],-1)),t("div",z,[t("button",{onClick:e[0]||(e[0]=s=>u.value=""),class:m(["px-4 py-2 text-sm font-medium rounded-lg transition",u.value===""?"bg-emerald-600/30 text-emerald-300 border border-emerald-500/50":"bg-slate-800/50 text-slate-400 border border-slate-700 hover:bg-slate-700/50 hover:text-slate-200"])},[e[4]||(e[4]=y(" All Years ",-1)),t("span",N,"("+a(p.value.length)+")",1)],2),(n(!0),l(h,null,k(C.value,s=>(n(),l("button",{key:s,onClick:d=>u.value=s,class:m(["px-4 py-2 text-sm font-medium rounded-lg transition",u.value===s?"bg-blue-600/30 text-blue-300 border border-blue-500/50":"bg-slate-800/50 text-slate-400 border border-slate-700 hover:bg-slate-700/50 hover:text-slate-200"])},[y(a(s)+" ",1),t("span",E,"("+a(L(s))+")",1)],10,T))),128))])]),t("div",P,[t("div",U,[R(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>b.value=s),type:"text",placeholder:"Search by name, staff ID, or reason...",class:"flex-1 px-3 py-2 text-sm bg-slate-800/50 border border-slate-700 rounded-lg text-slate-100 placeholder-slate-500 focus:outline-none focus:border-blue-500 transition"},null,512),[[I,b.value]]),t("button",{onClick:j,class:"px-3 py-2 text-sm bg-slate-800/50 border border-slate-700 rounded-lg text-slate-400 hover:text-slate-200 hover:border-slate-600 transition flex items-center justify-center",title:"Reset search"},[...e[6]||(e[6]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),v.value?(n(),l("div",H,[...e[7]||(e[7]=[t("div",{class:"inline-block w-12 h-12 border-4 border-blue-500/30 border-t-blue-500 rounded-full animate-spin"},null,-1),t("p",{class:"text-slate-400 mt-4"}," Loading inactive staff data... ",-1)])])):x.value?(n(),l("div",W,[e[8]||(e[8]=t("svg",{class:"w-12 h-12 text-red-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t("p",q,a(x.value),1),t("button",{onClick:S,class:"mt-4 px-4 py-2 bg-red-600/20 text-red-400 border border-red-600/30 rounded-lg hover:bg-red-600/30 transition"}," Retry ")])):_.value.length>0?(n(),l("div",G,[t("div",J,[t("table",O,[e[9]||(e[9]=t("thead",{class:"bg-slate-800/50"},[t("tr",null,[t("th",{class:"px-3 py-2 text-left text-[11px] font-semibold text-slate-300 uppercase tracking-wider"}," Report Day "),t("th",{class:"px-3 py-2 text-left text-[11px] font-semibold text-slate-300 uppercase tracking-wider"}," ID Staff "),t("th",{class:"px-3 py-2 text-left text-[11px] font-semibold text-slate-300 uppercase tracking-wider"}," Name Staff "),t("th",{class:"px-3 py-2 text-left text-[11px] font-semibold text-slate-300 uppercase tracking-wider"}," Position "),t("th",{class:"px-3 py-2 text-left text-[11px] font-semibold text-slate-300 uppercase tracking-wider"}," Superior "),t("th",{class:"px-3 py-2 text-left text-[11px] font-semibold text-slate-300 uppercase tracking-wider"}," Last Working Day "),t("th",{class:"px-3 py-2 text-left text-[11px] font-semibold text-slate-300 uppercase tracking-wider"}," Type "),t("th",{class:"px-3 py-2 text-left text-[11px] font-semibold text-slate-300 uppercase tracking-wider"}," Reason ")])],-1)),t("tbody",null,[(n(!0),l(h,null,k(_.value,s=>(n(),l("tr",{key:s.id,class:"hover:bg-slate-800/30 transition border-t border-slate-800/50"},[t("td",Q,a(f(s.report_day)),1),t("td",X,a(s.staff_id),1),t("td",K,a(s.staff_name),1),t("td",Z,a(s.staff_position||"-"),1),t("td",tt,a(s.staff_superior||"-"),1),t("td",et,a(f(s.last_working_day)),1),t("td",st,[t("span",{class:m(["px-2 py-1 text-xs font-medium rounded-full",s.resignation_type==="voluntary"?"bg-blue-500/20 text-blue-300 border border-blue-500/30":"bg-orange-500/20 text-orange-300 border border-orange-500/30"])},a(s.resignation_type==="voluntary"?"Voluntary":"Involuntary"),3)]),t("td",{class:"px-3 py-2 max-w-xs truncate",title:s.reason},a(s.reason),9,ot)]))),128))])])]),t("div",at,[(n(!0),l(h,null,k(_.value,s=>(n(),l("div",{key:s.id,class:"p-4 hover:bg-slate-800/30 transition"},[t("div",rt,[t("div",lt,[t("h3",nt,a(s.staff_name),1),t("p",dt,a(s.staff_id),1)]),t("span",{class:m(["px-2 py-1 text-xs font-medium rounded-full",s.resignation_type==="voluntary"?"bg-blue-500/20 text-blue-300 border border-blue-500/30":"bg-orange-500/20 text-orange-300 border border-orange-500/30"])},a(s.resignation_type==="voluntary"?"Voluntary":"Involuntary"),3)]),t("div",it,[t("div",null,[e[10]||(e[10]=t("p",{class:"text-slate-500"},"Report Day",-1)),t("p",ut,a(f(s.report_day)),1)]),t("div",null,[e[11]||(e[11]=t("p",{class:"text-slate-500"},"Last Working Day",-1)),t("p",ct,a(f(s.last_working_day)),1)]),t("div",null,[e[12]||(e[12]=t("p",{class:"text-slate-500"},"Position",-1)),t("p",pt,a(s.staff_position||"-"),1)]),t("div",null,[e[13]||(e[13]=t("p",{class:"text-slate-500"},"Superior",-1)),t("p",xt,a(s.staff_superior||"-"),1)]),t("div",bt,[e[14]||(e[14]=t("p",{class:"text-slate-500"},"Reason",-1)),t("p",ft,a(s.reason),1)])])]))),128))])])):(n(),l("div",mt,[...e[15]||(e[15]=[t("svg",{class:"w-16 h-16 text-slate-600 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})],-1),t("p",{class:"text-slate-400 text-lg"}," No resignation records found ",-1)])]))])]))}};$(vt).mount("#app");
