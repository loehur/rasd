import{r as u,c as s,o as l,a as t,g as c,j as B,w as y,n as D,t as n,u as L,F as k,k as w,b as z}from"./tailwind-DcM_4Xe1.js";import{A as F}from"./api-B5AYly-x.js";const P={class:"min-h-screen bg-slate-950 text-slate-100 p-6"},N={class:"max-w-4xl mx-auto"},R={class:"bg-slate-900/70 backdrop-blur border border-slate-800/80 rounded-2xl p-6 mb-6"},U={key:0,class:"w-16 h-16 mx-auto mb-4 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},H={key:1,class:"mb-4"},O={class:"text-lg font-semibold text-emerald-400"},K={class:"text-sm text-slate-400 mt-1"},q={key:2},G={class:"mt-4 flex items-center justify-between"},J=["href"],Q={key:0,class:"bg-slate-900/70 backdrop-blur border border-slate-800/80 rounded-2xl p-6 mb-6"},W={class:"text-lg font-bold text-slate-100 mb-4"},X={class:"overflow-x-auto"},Y={class:"w-full text-sm border-collapse border border-slate-700 rounded-lg"},Z={class:"bg-slate-800/50"},ee={key:0,class:"text-xs text-slate-500 mt-2"},te={key:1,class:"flex gap-4"},se=["disabled"],le={key:0,class:"w-5 h-5 border-2 border-white/70 border-t-transparent rounded-full animate-spin"},ae={class:"font-semibold mb-2"},oe={key:0,class:"mt-2"},re={class:"text-xs space-y-1 max-h-40 overflow-y-auto"},ne={__name:"ImportTeamLeader",setup(de){const r=u(null),v=u([]),i=u([]),b=u(!1),x=u(!1),m=u(""),h=u(!1),g=u([]),V=a=>{const e=a.target.files[0];e&&e.type==="text/csv"?(r.value=e,_(e)):alert("Please select a valid CSV file")},I=a=>{b.value=!1;const e=a.dataTransfer.files[0];e&&e.type==="text/csv"&&(r.value=e,_(e))},_=a=>{const e=new FileReader;e.onload=o=>{const p=o.target.result.split(`
`).filter(f=>f.trim());p.length>0&&(v.value=p[0].split(",").map(f=>f.trim()),i.value=p.slice(1).map(f=>{const A=f.split(","),S={};return v.value.forEach(($,E)=>{S[$]=A[E]?.trim()||""}),S}))},e.readAsText(a)},C=()=>{r.value=null,v.value=[],i.value=[],m.value=""},T=a=>a<1024?a+" B":a<1048576?(a/1024).toFixed(2)+" KB":(a/1048576).toFixed(2)+" MB",j=async()=>{if(r.value){x.value=!0,m.value="",g.value=[];try{const a=localStorage.getItem("auth_token"),e=new FormData;e.append("file",r.value);const d=await(await fetch(`${F}/api/team-leaders/import`,{method:"POST",headers:{Authorization:`Bearer ${a}`},body:e})).json();d.success?(h.value=!0,m.value=d.message,g.value=d.data?.errors||[],setTimeout(()=>{C()},3e3)):(h.value=!1,m.value=d.message||"Import failed. Please check your CSV format.")}catch(a){h.value=!1,m.value="Error: "+a.message}finally{x.value=!1}}},M=()=>{window.location.href="/admin/dashboard"};return(a,e)=>(l(),s("div",P,[t("div",N,[t("div",{class:"mb-8"},[t("button",{onClick:M,class:"mb-4 text-slate-400 hover:text-slate-200 flex items-center gap-2 transition"},[...e[3]||(e[3]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),B(" Back to Dashboard ",-1)])]),e[4]||(e[4]=t("h1",{class:"text-3xl font-black bg-clip-text text-transparent bg-gradient-to-r from-white via-slate-100 to-slate-300"}," Import Team Leader Data ",-1)),e[5]||(e[5]=t("p",{class:"text-slate-400 mt-2"},[B(" Upload CSV file to import team leaders with default password: "),t("span",{class:"font-mono text-emerald-400"},"tl1230")],-1))]),t("div",R,[e[10]||(e[10]=t("h2",{class:"text-lg font-bold text-slate-100 mb-4"}," Upload CSV File ",-1)),t("div",{class:D(["border-2 border-dashed border-slate-700 rounded-xl p-8 text-center hover:border-blue-500/50 transition-all cursor-pointer",{"border-blue-500 bg-blue-500/5":b.value}]),onClick:e[0]||(e[0]=o=>a.$refs.fileInput.click()),onDragover:e[1]||(e[1]=y(o=>b.value=!0,["prevent"])),onDragleave:e[2]||(e[2]=o=>b.value=!1),onDrop:y(I,["prevent"])},[t("input",{ref:"fileInput",type:"file",accept:".csv",onChange:V,class:"hidden"},null,544),r.value?c("",!0):(l(),s("svg",U,[...e[6]||(e[6]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"},null,-1)])])),r.value?(l(),s("div",H,[e[7]||(e[7]=t("div",{class:"w-16 h-16 mx-auto mb-4 bg-emerald-500/20 rounded-xl flex items-center justify-center"},[t("svg",{class:"w-8 h-8 text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1)),t("p",O,n(r.value.name),1),t("p",K,n(T(r.value.size))+" â€¢ "+n(i.value.length)+" rows detected ",1)])):(l(),s("div",q,[...e[8]||(e[8]=[t("p",{class:"text-slate-400 mb-2"}," Click to upload or drag and drop ",-1),t("p",{class:"text-xs text-slate-500"}," CSV files only (max 2MB) ",-1)])])),r.value?(l(),s("button",{key:3,onClick:y(C,["stop"]),class:"mt-4 px-4 py-2 text-sm bg-red-600/20 text-red-400 border border-red-600/30 rounded-lg hover:bg-red-600/30 transition"}," Remove File ")):c("",!0)],34),t("div",G,[e[9]||(e[9]=t("p",{class:"text-sm text-slate-400"},"Don't have a CSV file?",-1)),t("a",{href:`${L(F)}/api/team-leaders/template`,download:"",class:"text-sm font-medium text-blue-400 hover:text-blue-300 underline"}," Download Template ",8,J)])]),i.value.length>0?(l(),s("div",Q,[t("h2",W," Preview ("+n(i.value.length)+" rows) ",1),t("div",X,[t("table",Y,[t("thead",Z,[t("tr",null,[(l(!0),s(k,null,w(v.value,o=>(l(),s("th",{key:o,class:"border border-slate-700 px-3 py-2 text-left text-xs font-semibold text-slate-300 uppercase"},n(o),1))),128))])]),t("tbody",null,[(l(!0),s(k,null,w(i.value.slice(0,5),(o,d)=>(l(),s("tr",{key:d,class:"hover:bg-slate-800/30"},[(l(!0),s(k,null,w(v.value,p=>(l(),s("td",{key:p,class:"border border-slate-700 px-3 py-2 text-slate-300"},n(o[p]||"-"),1))),128))]))),128))])])]),i.value.length>5?(l(),s("p",ee," Showing first 5 of "+n(i.value.length)+" rows ",1)):c("",!0)])):c("",!0),r.value?(l(),s("div",te,[t("button",{onClick:j,disabled:x.value,class:"flex-1 py-3 px-6 bg-gradient-to-r from-blue-600 to-emerald-500 text-white font-semibold rounded-xl hover:from-blue-500 hover:to-emerald-400 transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"},[x.value?(l(),s("span",le)):c("",!0),t("span",null,n(x.value?"Importing...":"Import Team Leader Data"),1)],8,se)])):c("",!0),m.value?(l(),s("div",{key:2,class:D(["mt-6 p-4 rounded-xl border",h.value?"bg-emerald-500/10 border-emerald-500/30 text-emerald-300":"bg-red-500/10 border-red-500/30 text-red-300"])},[t("p",ae,n(m.value),1),g.value.length>0?(l(),s("div",oe,[e[11]||(e[11]=t("p",{class:"text-sm font-semibold mb-1"},"Errors:",-1)),t("ul",re,[(l(!0),s(k,null,w(g.value,(o,d)=>(l(),s("li",{key:d}," â€¢ "+n(o),1))),128))])])):c("",!0)],2)):c("",!0)])]))}};z(ne).mount("#app");
