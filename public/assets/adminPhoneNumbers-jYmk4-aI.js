import{r as i,j as I,c as a,o as r,p as z,a as e,d as h,b as B,e as k,v as w,t as d,F as V,l as F,w as T,g as P,n as L,h as U}from"./tailwind-DNrR0bkN.js";import{_ as R}from"./AdminHeader-KbfMcPGE.js";import{A as S}from"./api-rG_fphBW.js";const q={class:"min-h-screen bg-slate-950 text-slate-100"},J={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},O={class:"bg-slate-900/70 backdrop-blur border border-slate-800/80 rounded-xl shadow-sm"},Q={class:"px-6 py-4 border-b border-slate-800/80"},Y={class:"mt-4"},G={class:"flex gap-3"},H={class:"flex-1"},K={key:0,class:"mt-1 text-sm text-red-400"},W=["disabled"],X={key:0,class:"p-8 text-center"},Z={key:1,class:"p-8 text-center text-red-400"},ee={key:2,class:"overflow-x-auto"},te={class:"w-full"},se={class:"bg-slate-800/50"},oe={key:0,class:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider"},ae={class:"divide-y divide-slate-800/80"},re={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-slate-200"},ne={class:"px-6 py-4 whitespace-nowrap text-sm text-slate-300"},le={class:"px-6 py-4 whitespace-nowrap text-sm text-slate-400"},ie={class:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-emerald-400"},de={class:"px-6 py-4 text-sm text-slate-400"},ue={class:"px-6 py-4 whitespace-nowrap text-sm text-slate-500"},ce={key:0,class:"px-6 py-4 whitespace-nowrap text-sm"},pe={class:"flex gap-2"},me=["onClick"],he=["onClick"],xe={key:3,class:"p-8 text-center text-slate-500"},be={key:0,class:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50"},ve={class:"bg-slate-900 border border-slate-700 rounded-xl shadow-2xl p-6 max-w-md w-full mx-4"},fe={class:"flex gap-3 justify-end mt-6"},ge=["disabled"],ye={class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},_e={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},ke={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},we={__name:"AdminPhoneNumbersApp",setup(Se){const f=i([]),g=i(!0),x=i(""),v=i(!1),p=i({show:!1,message:"",type:"success"}),n=i(""),m=i(""),y=i(!1),l=i({id:null,phone_number:"",remarks:""}),_=i(!1);I(()=>{const s=localStorage.getItem("user");if(s)try{const t=JSON.parse(s);_.value=t.role==="super-admin"}catch{}b()});const b=async()=>{g.value=!0,x.value="";try{const s=localStorage.getItem("auth_token");let t=`${S}/api/phone-numbers`;n.value&&n.value.length>=8&&(t+=`?search=${encodeURIComponent(n.value)}`);const c=await(await fetch(t,{headers:{Authorization:`Bearer ${s}`,Accept:"application/json"}})).json();c.success?f.value=c.data:x.value=c.message||"Failed to fetch phone numbers"}catch(s){x.value="Failed to connect to server",console.error("Error:",s)}finally{g.value=!1}},A=()=>{m.value="",n.value.length>0&&n.value.length<8&&(m.value="Please enter at least 8 digits")},C=async()=>{if(n.value.length>0&&n.value.length<8){m.value="Please enter at least 8 digits";return}b()},E=()=>{n.value="",m.value="",b()},j=s=>{l.value={id:s.id,phone_number:s.phone_number,remarks:s.remarks},y.value=!0},M=async()=>{if(!l.value.phone_number.trim()){u("Please enter a phone number","error");return}if(!l.value.remarks.trim()){u("Please enter remarks","error");return}v.value=!0;try{const s=localStorage.getItem("auth_token"),o=await(await fetch(`${S}/api/phone-numbers/${l.value.id}`,{method:"PUT",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({phone_number:l.value.phone_number,remarks:l.value.remarks})})).json();o.success?(u("Phone number updated successfully!","success"),N(),b()):u(o.message||"Failed to update phone number","error")}catch(s){u("Failed to connect to server","error"),console.error("Error:",s)}finally{v.value=!1}},N=()=>{y.value=!1,l.value={id:null,phone_number:"",remarks:""}},$=async s=>{if(confirm("Are you sure you want to delete this phone number?"))try{const t=localStorage.getItem("auth_token"),c=await(await fetch(`${S}/api/phone-numbers/${s}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`,Accept:"application/json"}})).json();c.success?(u("Phone number deleted successfully","success"),b()):u(c.message||"Failed to delete phone number","error")}catch(t){u("Failed to connect to server","error"),console.error("Error:",t)}},D=s=>s?new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-",u=(s,t="success")=>{p.value={show:!0,message:s,type:t},setTimeout(()=>{p.value.show=!1},3e3)};return(s,t)=>(r(),a("div",q,[z(R,{title:"Phone Numbers",subtitle:"Manage Contact Information"}),e("main",J,[t[11]||(t[11]=B('<div class="mb-6"><h1 class="text-2xl font-bold text-slate-100">Phone Numbers Management</h1><p class="text-sm text-slate-400 mt-1">View, edit, and manage phone numbers from all staff</p></div><div class="mb-6 bg-blue-900/20 border border-blue-800/50 rounded-lg p-4"><div class="flex items-start gap-3"><svg class="w-5 h-5 text-blue-400 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><p class="text-sm text-blue-200"> As admin, you can view all phone numbers from all staff. You can edit and delete entries, but cannot add new ones (staff add their own data). </p></div></div>',2)),e("div",O,[e("div",Q,[t[3]||(t[3]=e("div",{class:"flex items-center justify-between"},[e("h2",{class:"text-lg font-bold text-slate-100"},"Phone Numbers List"),e("div",{class:"text-sm text-slate-500"},"Showing last 20 entries")],-1)),e("div",Y,[e("div",G,[e("div",H,[k(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>n.value=o),type:"text",placeholder:"Search phone number (min. 8 digits)",class:"w-full px-4 py-2 bg-slate-950 border border-slate-700 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-slate-100 placeholder-slate-500",onInput:A},null,544),[[w,n.value]]),m.value?(r(),a("p",K,d(m.value),1)):h("",!0)]),e("button",{onClick:C,disabled:n.value.length>0&&n.value.length<8,class:"px-6 py-2 bg-indigo-600 text-white font-semibold rounded-lg hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"}," Search ",8,W),n.value?(r(),a("button",{key:0,onClick:E,class:"px-6 py-2 bg-slate-700 text-slate-200 font-semibold rounded-lg hover:bg-slate-600 transition-colors"}," Clear ")):h("",!0)])])]),g.value?(r(),a("div",X,[...t[4]||(t[4]=[e("div",{class:"inline-block h-8 w-8 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"},null,-1),e("p",{class:"mt-2 text-slate-400"},"Loading...",-1)])])):x.value?(r(),a("div",Z,d(x.value),1)):f.value.length>0?(r(),a("div",ee,[e("table",te,[e("thead",se,[e("tr",null,[t[5]||(t[5]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider"}," Employee ID ",-1)),t[6]||(t[6]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider"}," Employee Name ",-1)),t[7]||(t[7]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider"}," Team Leader ",-1)),t[8]||(t[8]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider"}," Phone Number ",-1)),t[9]||(t[9]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider"}," Remarks ",-1)),t[10]||(t[10]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider"}," Date Added ",-1)),_.value?(r(),a("th",oe," Actions ")):h("",!0)])]),e("tbody",ae,[(r(!0),a(V,null,F(f.value,o=>(r(),a("tr",{key:o.id,class:"hover:bg-slate-800/30 transition-colors"},[e("td",re,d(o.staff_id),1),e("td",ne,d(o.employee_name),1),e("td",le,d(o.team_leader_name||"-"),1),e("td",ie,d(o.phone_number),1),e("td",de,d(o.remarks||"-"),1),e("td",ue,d(D(o.created_at)),1),_.value?(r(),a("td",ce,[e("div",pe,[e("button",{onClick:c=>j(o),class:"text-indigo-400 hover:text-indigo-300 font-medium transition-colors"}," Edit ",8,me),e("button",{onClick:c=>$(o.id),class:"text-rose-400 hover:text-rose-300 font-medium transition-colors"}," Delete ",8,he)])])):h("",!0)]))),128))])])])):(r(),a("div",xe," No phone numbers found. "))])]),y.value?(r(),a("div",be,[e("div",ve,[t[14]||(t[14]=e("h3",{class:"text-xl font-bold text-slate-100 mb-4"},"Edit Phone Number",-1)),e("form",{onSubmit:T(M,["prevent"]),class:"space-y-4"},[e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-slate-300 mb-2"},[P(" Phone Number "),e("span",{class:"text-rose-500"},"*")],-1)),k(e("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>l.value.phone_number=o),type:"tel",required:"",class:"w-full px-4 py-2 bg-slate-950 border border-slate-700 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-slate-100 placeholder-slate-500"},null,512),[[w,l.value.phone_number]])]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-slate-300 mb-2"},[P(" Remarks "),e("span",{class:"text-rose-500"},"*")],-1)),k(e("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>l.value.remarks=o),type:"text",required:"",class:"w-full px-4 py-2 bg-slate-950 border border-slate-700 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-slate-100 placeholder-slate-500"},null,512),[[w,l.value.remarks]])]),e("div",fe,[e("button",{type:"button",onClick:N,class:"px-4 py-2 border border-slate-600 text-slate-300 rounded-lg hover:bg-slate-800 transition-colors"}," Cancel "),e("button",{type:"submit",disabled:v.value,class:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-500 disabled:opacity-50 transition-colors"},d(v.value?"Saving...":"Save Changes"),9,ge)])],32)])])):h("",!0),p.value.show?(r(),a("div",{key:1,class:L(["fixed top-4 right-4 px-6 py-4 rounded-lg shadow-lg z-50 flex items-center space-x-3",p.value.type==="success"?"bg-emerald-600":"bg-rose-600","text-white"])},[(r(),a("svg",ye,[p.value.type==="success"?(r(),a("path",_e)):(r(),a("path",ke))])),e("span",null,d(p.value.message),1)],2)):h("",!0)]))}};U(we).mount("#app");
