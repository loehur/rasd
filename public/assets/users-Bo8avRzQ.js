import{r as u,j as A,c as l,o as n,a as e,g as N,d as w,t as i,w as B,e as v,v as y,F as I,k as j,n as P,h as U}from"./tailwind-BChqtM0q.js";import{A as b}from"./api-n_PshMHp.js";const C={class:"min-h-screen bg-slate-950 text-slate-100"},R={class:"px-3 sm:px-6 lg:px-8 py-4"},T={class:"max-w-4xl mx-auto space-y-6"},$={class:"bg-slate-900/70 backdrop-blur border border-slate-800/80 rounded-2xl p-6"},O={class:"flex items-center justify-between mb-4"},z={class:"text-xs px-2 py-1 rounded bg-slate-800/60 border border-slate-700"},E={key:0,class:"p-4 bg-yellow-500/10 border border-yellow-500/30 rounded-xl text-yellow-400"},J={key:1},M={class:"sm:col-span-2 flex justify-end"},V=["disabled"],D={class:"overflow-x-auto -mx-3 sm:mx-0"},L={class:"min-w-full text-sm"},F={class:"py-2 break-words px-3 sm:px-0"},X={class:"py-2 break-words px-3 sm:px-0"},q={class:"py-2"},G={class:"py-2"},H=["onClick"],K={class:"text-white"},Q={__name:"UsersPage",setup(W){const p=u({role:""}),x=u([]),a=u({name:"",phone_number:""}),m=u(!1),c=u({show:!1,message:"",type:"success"});A(async()=>{const t=localStorage.getItem("user");if(!t){window.location.href="/admin";return}p.value=JSON.parse(t),await g()});const g=async()=>{try{const t=localStorage.getItem("auth_token"),s=JSON.parse(localStorage.getItem("user")||"{}").role,r=await(await fetch(`${b}/api/users`,{method:"GET",headers:{Authorization:`Bearer ${t}`,"X-Role":s}})).json();r.success&&(x.value=r.data)}catch(t){console.error("Load users error:",t)}},f=async()=>{m.value=!0;try{const t=localStorage.getItem("auth_token"),s=JSON.parse(localStorage.getItem("user")||"{}").role,r=await(await fetch(`${b}/api/users`,{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json","X-Role":s},body:JSON.stringify({name:a.value.name,phone_number:a.value.phone_number})})).json();r.success?(d("Admin user created"),a.value={name:"",phone_number:""},await g()):d(r.message||"Failed to create","error")}catch{d("Error creating user","error")}finally{m.value=!1}},_=async t=>{try{const s=localStorage.getItem("auth_token"),o=JSON.parse(localStorage.getItem("user")||"{}").role,h=await(await fetch(`${b}/api/users/${t}/reset-password`,{method:"POST",headers:{Authorization:`Bearer ${s}`,"X-Role":o}})).json();h.success?d('Password reset to "Admin123!"'):d(h.message||"Reset failed","error")}catch{d("Error resetting password","error")}},d=(t,s="success")=>{c.value={show:!0,message:t,type:s},setTimeout(()=>{c.value.show=!1},3e3)},k=()=>{localStorage.removeItem("auth_token"),localStorage.removeItem("user"),window.location.href="/admin"},S=()=>{window.location.href="/admin/dashboard"};return(t,s)=>(n(),l("div",C,[e("nav",{class:"bg-slate-900/80 backdrop-blur border-b border-slate-800/80 sticky top-0 z-50"},[e("div",{class:"px-3 sm:px-6 lg:px-8 h-16 flex items-center justify-between"},[e("div",{class:"flex items-center gap-3"},[e("button",{onClick:S,class:"text-slate-300 hover:text-slate-100 text-sm flex items-center gap-2"},[...s[2]||(s[2]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),N(" Back to Dashboard ",-1)])]),s[3]||(s[3]=e("span",{class:"hidden sm:inline text-sm font-bold tracking-wider text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-emerald-400"},"Admin Users",-1))]),e("button",{onClick:k,class:"text-red-400 hover:text-red-300 text-sm"}," Logout ")])]),e("main",R,[e("div",T,[e("div",$,[e("div",O,[s[4]||(s[4]=e("h2",{class:"text-xl font-bold"},"Manage Users",-1)),e("span",z,"Role: "+i(p.value.role),1)]),p.value.role!=="super-admin"?(n(),l("div",E," Hanya super-admin yang dapat mengakses halaman Users. ")):(n(),l("div",J,[e("form",{onSubmit:B(f,["prevent"]),class:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 mb-6"},[e("div",null,[s[5]||(s[5]=e("label",{class:"block text-sm text-slate-300 mb-2"},"Name *",-1)),v(e("input",{"onUpdate:modelValue":s[0]||(s[0]=o=>a.value.name=o),type:"text",required:"",class:"w-full px-3 sm:px-4 py-2 bg-slate-800/50 border border-slate-700 rounded-lg"},null,512),[[y,a.value.name]])]),e("div",null,[s[6]||(s[6]=e("label",{class:"block text-sm text-slate-300 mb-2"},"Phone Number *",-1)),v(e("input",{"onUpdate:modelValue":s[1]||(s[1]=o=>a.value.phone_number=o),type:"text",required:"",class:"w-full px-3 sm:px-4 py-2 bg-slate-800/50 border border-slate-700 rounded-lg"},null,512),[[y,a.value.phone_number]])]),e("div",M,[e("button",{disabled:m.value,class:"w-full sm:w-auto px-5 sm:px-6 py-2 bg-emerald-600 hover:bg-emerald-700 rounded-lg text-white disabled:opacity-50"},i(m.value?"Saving...":"Add Admin"),9,V)])],32),e("div",D,[e("table",L,[s[7]||(s[7]=e("thead",null,[e("tr",{class:"text-left text-slate-300 border-b border-slate-800"},[e("th",{class:"py-2 px-3 sm:px-0"},"Name"),e("th",{class:"py-2 px-3 sm:px-0"},"Phone"),e("th",{class:"py-2"},"Role"),e("th",{class:"py-2"},"Actions")])],-1)),e("tbody",null,[(n(!0),l(I,null,j(x.value,o=>(n(),l("tr",{key:o.id,class:"border-b border-slate-800"},[e("td",F,i(o.name),1),e("td",X,i(o.phone_number),1),e("td",q,i(o.role),1),e("td",G,[o.role!=="super-admin"?(n(),l("button",{key:0,onClick:r=>_(o.id),class:"w-full sm:w-auto px-3 py-1 text-sm bg-blue-600 hover:bg-blue-700 rounded text-white"}," Reset Password ",8,H)):w("",!0)])]))),128))])])])]))]),c.value.show?(n(),l("div",{key:0,class:P(["fixed top-4 left-1/2 -translate-x-1/2 sm:left-auto sm:translate-x-0 sm:right-4 px-4 sm:px-6 py-3 sm:py-4 rounded-lg shadow-lg z-50",c.value.type==="success"?"bg-green-600":"bg-red-600"])},[e("span",K,i(c.value.message),1)],2)):w("",!0)])])]))}};U(Q).mount("#app");
