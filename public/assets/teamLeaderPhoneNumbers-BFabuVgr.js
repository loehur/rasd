import{r as u,j as z,c as o,o as a,a as e,d as c,w as A,e as b,v as g,g as k,t as d,F as V,l as F,n as T,h as L}from"./tailwind-ChUXPuL2.js";import{A as S}from"./api-DjxYVOX3.js";const $={class:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50"},R={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},q={key:0,class:"mb-8 bg-white rounded-xl shadow-sm p-6 border border-gray-200"},O={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},J={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Y={class:"flex justify-end"},Q=["disabled"],G={key:1,class:"mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4"},H={key:2,class:"mb-6 bg-green-50 border border-green-200 rounded-lg p-4"},K={class:"bg-white rounded-xl shadow-sm border border-gray-200"},W={class:"px-6 py-4 border-b border-gray-200"},X={class:"mt-4"},Z={class:"flex gap-3"},ee={class:"flex-1"},te={key:0,class:"mt-1 text-sm text-red-600"},se=["disabled"],re={key:0,class:"p-8 text-center"},oe={key:1,class:"p-8 text-center text-red-600"},ae={key:2,class:"overflow-x-auto"},le={class:"w-full"},ne={class:"bg-white divide-y divide-gray-200"},de={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},ue={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ie={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-600"},me={class:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-blue-600"},pe={class:"px-6 py-4 text-sm text-gray-600"},ce={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-600"},be={key:3,class:"p-8 text-center text-gray-500"},ge={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},xe={class:"bg-white rounded-xl shadow-xl p-6 max-w-md w-full mx-4"},ye={class:"flex gap-3 justify-end"},he=["disabled"],ve={class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},fe={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},ke={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},we={__name:"PhoneNumbersApp",setup(_e){const w=u([]),_=u(!0),v=u(""),p=u(!1),x=u(""),y=u({show:!1,message:"",type:"success"}),n=u(""),h=u(""),P=u(!1),i=u({id:null,phone_number:"",remarks:""}),l=u({employeeId:"",employeeName:"",teamLeaderName:"",phoneNumber:"",remarks:""});z(()=>{const r=JSON.parse(localStorage.getItem("tl_user")||"{}");x.value=r.role||"",x.value==="staff"&&(l.value.employeeId=r.employee_id||"",l.value.employeeName=r.name||""),f()});const f=async()=>{_.value=!0,v.value="";try{const r=localStorage.getItem("tl_auth_token");let t=`${S}/api/phone-numbers`;n.value&&n.value.length>=8&&(t+=`?search=${encodeURIComponent(n.value)}`);const N=await(await fetch(t,{headers:{Authorization:`Bearer ${r}`,Accept:"application/json"}})).json();N.success?w.value=N.data:v.value=N.message||"Failed to fetch phone numbers"}catch(r){v.value="Failed to connect to server",console.error("Error:",r)}finally{_.value=!1}},E=async()=>{if(!l.value.phoneNumber.trim()){m("Please enter a phone number","error");return}if(!l.value.remarks.trim()){m("Please enter remarks","error");return}p.value=!0;try{const r=localStorage.getItem("tl_auth_token"),s=await(await fetch(`${S}/api/phone-numbers`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({phone_number:l.value.phoneNumber,remarks:l.value.remarks})})).json();s.success?(m("Phone number added successfully!","success"),l.value.phoneNumber="",l.value.remarks="",f()):m(s.message||"Failed to add phone number","error")}catch(r){m("Failed to connect to server","error"),console.error("Error:",r)}finally{p.value=!1}},I=r=>r?new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-",m=(r,t="success")=>{y.value={show:!0,message:r,type:t},setTimeout(()=>{y.value.show=!1},3e3)},C=()=>{h.value="",n.value.length>0&&n.value.length<8&&(h.value="Please enter at least 8 digits")},M=async()=>{if(n.value.length>0&&n.value.length<8){h.value="Please enter at least 8 digits";return}f()},B=()=>{n.value="",h.value="",f()},D=async()=>{if(!i.value.phone_number.trim()){m("Please enter a phone number","error");return}if(!i.value.remarks.trim()){m("Please enter remarks","error");return}p.value=!0;try{const r=localStorage.getItem("tl_auth_token"),s=await(await fetch(`${S}/api/phone-numbers/${i.value.id}`,{method:"PUT",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({phone_number:i.value.phone_number,remarks:i.value.remarks})})).json();s.success?(m("Phone number updated successfully!","success"),j(),f()):m(s.message||"Failed to update phone number","error")}catch(r){m("Failed to connect to server","error"),console.error("Error:",r)}finally{p.value=!1}},j=()=>{P.value=!1,i.value={id:null,phone_number:"",remarks:""}},U=()=>{localStorage.removeItem("tl_auth_token"),localStorage.removeItem("tl_user"),window.location.href="/"};return(r,t)=>(a(),o("div",$,[e("header",{class:"bg-gradient-to-r from-slate-50 via-indigo-50 to-sky-50 text-slate-800 border-b border-slate-200 shadow-sm"},[e("div",{class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4"},[e("div",{class:"flex justify-between items-center"},[t[8]||(t[8]=e("div",null,[e("h1",{class:"text-2xl font-bold tracking-tight"},"Phone Numbers"),e("p",{class:"text-sm text-slate-600 mt-1"},"Manage phone number entries")],-1)),e("div",{class:"flex items-center gap-4"},[t[7]||(t[7]=e("a",{href:"/team-leader/dashboard",class:"text-sm text-slate-600 hover:text-slate-900"}," â† Back to Dashboard ",-1)),e("button",{onClick:U,class:"px-4 py-2 text-sm font-medium bg-red-600 text-white rounded-lg hover:bg-red-700"}," Logout ")])])])]),e("main",R,[x.value==="staff"?(a(),o("div",q,[t[13]||(t[13]=e("h2",{class:"text-lg font-bold text-gray-900 mb-4"},"Add New Phone Number",-1)),e("form",{onSubmit:A(E,["prevent"]),class:"space-y-4"},[e("div",O,[e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Employee ID ",-1)),b(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>l.value.employeeId=s),type:"text",readonly:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-50"},null,512),[[g,l.value.employeeId]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Employee Name ",-1)),b(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>l.value.employeeName=s),type:"text",readonly:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-50"},null,512),[[g,l.value.employeeName]])])]),e("div",J,[e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[k(" Phone Number "),e("span",{class:"text-red-500"},"*")],-1)),b(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>l.value.phoneNumber=s),type:"tel",required:"",placeholder:"Enter phone number",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,512),[[g,l.value.phoneNumber]])]),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[k(" Remarks "),e("span",{class:"text-red-500"},"*")],-1)),b(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>l.value.remarks=s),type:"text",required:"",placeholder:"Enter remarks (required)",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,512),[[g,l.value.remarks]])])]),e("div",Y,[e("button",{type:"submit",disabled:p.value,class:"px-6 py-2 bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-semibold rounded-lg hover:from-blue-700 hover:to-indigo-700 disabled:opacity-50"},d(p.value?"Adding...":"Add Phone Number"),9,Q)])],32)])):c("",!0),x.value==="team_leader"?(a(),o("div",G,[...t[14]||(t[14]=[e("div",{class:"flex items-start gap-3"},[e("svg",{class:"w-5 h-5 text-blue-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("p",{class:"text-sm text-blue-800"}," You are viewing phone numbers from your team. Staff can add entries, but only admin can edit or delete. ")],-1)])])):c("",!0),x.value==="staff"?(a(),o("div",H,[...t[15]||(t[15]=[e("div",{class:"flex items-start gap-3"},[e("svg",{class:"w-5 h-5 text-green-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("p",{class:"text-sm text-green-800"}," You can add new phone numbers using the form above. Only admin can edit or delete entries. ")],-1)])])):c("",!0),e("div",K,[e("div",W,[t[16]||(t[16]=e("div",{class:"flex items-center justify-between"},[e("h2",{class:"text-lg font-bold text-gray-900"},"Phone Numbers List"),e("div",{class:"text-sm text-gray-600"},"Showing last 20 entries")],-1)),e("div",X,[e("div",Z,[e("div",ee,[b(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>n.value=s),type:"text",placeholder:"Search phone number (min. 8 digits)",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",onInput:C},null,544),[[g,n.value]]),h.value?(a(),o("p",te,d(h.value),1)):c("",!0)]),e("button",{onClick:M,disabled:n.value.length>0&&n.value.length<8,class:"px-6 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed"}," Search ",8,se),n.value?(a(),o("button",{key:0,onClick:B,class:"px-6 py-2 bg-gray-600 text-white font-semibold rounded-lg hover:bg-gray-700"}," Clear ")):c("",!0)])])]),_.value?(a(),o("div",re,[...t[17]||(t[17]=[e("div",{class:"inline-block h-8 w-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"},null,-1),e("p",{class:"mt-2 text-gray-600"},"Loading...",-1)])])):v.value?(a(),o("div",oe,d(v.value),1)):w.value.length>0?(a(),o("div",ae,[e("table",le,[t[18]||(t[18]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Employee ID "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Employee Name "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Team Leader "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Phone Number "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Remarks "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Date Added ")])],-1)),e("tbody",ne,[(a(!0),o(V,null,F(w.value,s=>(a(),o("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",de,d(s.staff_id),1),e("td",ue,d(s.employee_name),1),e("td",ie,d(s.team_leader_name||"-"),1),e("td",me,d(s.phone_number),1),e("td",pe,d(s.remarks||"-"),1),e("td",ce,d(I(s.created_at)),1)]))),128))])])])):(a(),o("div",be," No phone numbers found. "+d(x.value==="staff"?"Add your first entry above!":""),1))])]),P.value?(a(),o("div",ge,[e("div",xe,[t[21]||(t[21]=e("h3",{class:"text-xl font-bold text-gray-900 mb-4"},"Edit Phone Number",-1)),e("form",{onSubmit:A(D,["prevent"]),class:"space-y-4"},[e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[k(" Phone Number "),e("span",{class:"text-red-500"},"*")],-1)),b(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>i.value.phone_number=s),type:"tel",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,512),[[g,i.value.phone_number]])]),e("div",null,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[k(" Remarks "),e("span",{class:"text-red-500"},"*")],-1)),b(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>i.value.remarks=s),type:"text",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,512),[[g,i.value.remarks]])]),e("div",ye,[e("button",{type:"button",onClick:j,class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50"}," Cancel "),e("button",{type:"submit",disabled:p.value,class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50"},d(p.value?"Saving...":"Save Changes"),9,he)])],32)])])):c("",!0),y.value.show?(a(),o("div",{key:1,class:T(["fixed top-4 right-4 px-6 py-4 rounded-lg shadow-lg z-50 flex items-center space-x-3",y.value.type==="success"?"bg-green-500":"bg-red-500","text-white"])},[(a(),o("svg",ve,[y.value.type==="success"?(a(),o("path",fe)):(a(),o("path",ke))])),e("span",null,d(y.value.message),1)],2)):c("",!0)]))}};L(we).mount("#app");
