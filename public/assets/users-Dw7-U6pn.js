const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/api-DDGvwgGv.js","assets/api-n_PshMHp.js"])))=>i.map(i=>d[i]);
import{r as f,j as U,c as n,o as d,a as e,g as N,d as v,t as m,w as $,e as S,v as A,F as E,l as C,n as j,h as R}from"./tailwind-DdHGqa1K.js";import{A as w}from"./api-n_PshMHp.js";const B="modulepreload",T=function(_){return"/"+_},P={},I=function(u,h,p){let x=Promise.resolve();if(h&&h.length>0){let y=function(a){return Promise.all(a.map(r=>Promise.resolve(r).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),c=i?.nonce||i?.getAttribute("nonce");x=y(h.map(a=>{if(a=T(a),a in P)return;P[a]=!0;const r=a.endsWith(".css"),g=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${g}`))return;const o=document.createElement("link");if(o.rel=r?"stylesheet":B,r||(o.as="script"),o.crossOrigin="",o.href=a,c&&o.setAttribute("nonce",c),document.head.appendChild(o),r)return new Promise((t,s)=>{o.addEventListener("load",t),o.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${a}`)))})}))}function b(i){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=i,window.dispatchEvent(c),!c.defaultPrevented)throw i}return x.then(i=>{for(const c of i||[])c.status==="rejected"&&b(c.reason);return u().catch(b)})},O={class:"min-h-screen bg-slate-950 text-slate-100"},D={class:"px-3 sm:px-6 lg:px-8 py-4"},L={class:"max-w-4xl mx-auto space-y-6"},z={class:"bg-slate-900/70 backdrop-blur border border-slate-800/80 rounded-2xl p-6"},M={class:"flex items-center justify-between mb-4"},V={class:"text-xs px-2 py-1 rounded bg-slate-800/60 border border-slate-700"},J={key:0,class:"p-4 bg-yellow-500/10 border border-yellow-500/30 rounded-xl text-yellow-400"},q={key:1},F={class:"sm:col-span-2 flex justify-end"},X=["disabled"],G={class:"overflow-x-auto -mx-3 sm:mx-0 hidden md:block"},H={class:"min-w-full text-sm"},W={class:"py-2 break-words px-3 sm:px-0"},K={class:"py-2 break-words px-3 sm:px-0"},Q={class:"py-2"},Y={class:"py-2 flex items-center gap-2"},Z=["onClick"],ee=["onClick"],te={class:"md:hidden space-y-3"},se={class:"flex items-center justify-between"},oe={class:"text-sm font-semibold text-slate-100"},re={class:"text-xs text-slate-400"},ae={class:"text-xs px-2 py-1 rounded bg-slate-700 text-slate-300"},le={class:"mt-3 flex gap-2"},ne=["onClick"],de=["onClick"],ie={class:"text-white"},ce={__name:"UsersPage",setup(_){const u=f({role:""}),h=f([]),p=f({name:"",phone_number:""}),x=f(!1),b=f({show:!1,message:"",type:"success"});U(async()=>{const o=localStorage.getItem("user");if(!o){window.location.href="/admin";return}u.value=JSON.parse(o),await i()});const i=async()=>{try{const o=localStorage.getItem("auth_token"),t=JSON.parse(localStorage.getItem("user")||"{}").role,l=await(await fetch(`${w}/api/users`,{method:"GET",headers:{Authorization:`Bearer ${o}`,"X-Role":t}})).json();l.success&&(h.value=l.data)}catch(o){console.error("Load users error:",o)}},c=async()=>{x.value=!0;try{const o=localStorage.getItem("auth_token"),t=JSON.parse(localStorage.getItem("user")||"{}").role,l=await(await fetch(`${w}/api/users`,{method:"POST",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json","X-Role":t},body:JSON.stringify({name:p.value.name,phone_number:p.value.phone_number})})).json();l.success?(r("Admin user created"),p.value={name:"",phone_number:""},await i()):r(l.message||"Failed to create","error")}catch{r("Error creating user","error")}finally{x.value=!1}},y=async o=>{try{const t=localStorage.getItem("auth_token"),s=JSON.parse(localStorage.getItem("user")||"{}").role,k=await(await fetch(`${w}/api/users/${o}/reset-password`,{method:"POST",headers:{Authorization:`Bearer ${t}`,"X-Role":s}})).json();k.success?r('Password reset to "Admin123!"'):r(k.message||"Reset failed","error")}catch{r("Error resetting password","error")}},a=async o=>{try{if(u.value.role!=="super-admin"){r("Forbidden","error");return}const{deleteUser:t}=await I(async()=>{const{deleteUser:l}=await import("./api-DDGvwgGv.js");return{deleteUser:l}},__vite__mapDeps([0,1])),s=await t(o);s.success?(r("User deleted"),await i()):r(s.message||"Delete failed","error")}catch{r("Error deleting user","error")}},r=(o,t="success")=>{b.value={show:!0,message:o,type:t},setTimeout(()=>{b.value.show=!1},3e3)},g=()=>{window.location.href="/admin/dashboard"};return(o,t)=>(d(),n("div",O,[e("nav",{class:"bg-slate-900/80 backdrop-blur border-b border-slate-800/80 sticky top-0 z-50"},[e("div",{class:"px-3 sm:px-6 lg:px-8 h-16 flex items-center justify-between"},[e("div",{class:"flex items-center gap-3"},[e("button",{onClick:g,class:"text-slate-300 hover:text-slate-100 text-sm flex items-center gap-2"},[...t[2]||(t[2]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),N(" Back to Dashboard ",-1)])]),t[3]||(t[3]=e("span",{class:"hidden sm:inline text-sm font-bold tracking-wider text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-emerald-400"},"Admin Users",-1))])])]),e("main",D,[e("div",L,[e("div",z,[e("div",M,[t[4]||(t[4]=e("h2",{class:"text-xl font-bold"},"Manage Users",-1)),e("span",V,"Role: "+m(u.value.role),1)]),u.value.role!=="super-admin"?(d(),n("div",J," Hanya super-admin yang dapat mengakses halaman Users. ")):(d(),n("div",q,[e("form",{onSubmit:$(c,["prevent"]),class:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 mb-6"},[e("div",null,[t[5]||(t[5]=e("label",{class:"block text-sm text-slate-300 mb-2"},"Name *",-1)),S(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>p.value.name=s),type:"text",required:"",class:"w-full px-3 sm:px-4 py-2 bg-slate-800/50 border border-slate-700 rounded-lg"},null,512),[[A,p.value.name]])]),e("div",null,[t[6]||(t[6]=e("label",{class:"block text-sm text-slate-300 mb-2"},"Phone Number *",-1)),S(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>p.value.phone_number=s),type:"text",required:"",class:"w-full px-3 sm:px-4 py-2 bg-slate-800/50 border border-slate-700 rounded-lg"},null,512),[[A,p.value.phone_number]])]),e("div",F,[e("button",{disabled:x.value,class:"w-full sm:w-auto px-5 sm:px-6 py-2 bg-emerald-600 hover:bg-emerald-700 rounded-lg text-white disabled:opacity-50"},m(x.value?"Saving...":"Add Admin"),9,X)])],32),e("div",G,[e("table",H,[t[7]||(t[7]=e("thead",null,[e("tr",{class:"text-left text-slate-300 border-b border-slate-800"},[e("th",{class:"py-2 px-3 sm:px-0"},"Name"),e("th",{class:"py-2 px-3 sm:px-0"},"Phone"),e("th",{class:"py-2"},"Role"),e("th",{class:"py-2"},"Actions")])],-1)),e("tbody",null,[(d(!0),n(E,null,C(h.value,s=>(d(),n("tr",{key:s.id,class:"border-b border-slate-800"},[e("td",W,m(s.name),1),e("td",K,m(s.phone_number),1),e("td",Q,m(s.role),1),e("td",Y,[s.role!=="super-admin"&&u.value.role==="super-admin"?(d(),n("button",{key:0,onClick:l=>y(s.id),class:"w-full sm:w-auto px-3 py-1 text-sm bg-blue-600 hover:bg-blue-700 rounded text-white"}," Reset ",8,Z)):v("",!0),s.role!=="super-admin"&&u.value.role==="super-admin"?(d(),n("button",{key:1,onClick:l=>a(s.id),class:"w-full sm:w-auto px-3 py-1 text-sm bg-red-600 hover:bg-red-700 rounded text-white"}," Delete ",8,ee)):v("",!0)])]))),128))])])]),e("div",te,[(d(!0),n(E,null,C(h.value,s=>(d(),n("div",{key:s.id,class:"p-4 bg-slate-800/50 border border-slate-700 rounded-xl"},[e("div",se,[e("div",null,[e("p",oe,m(s.name),1),e("p",re,m(s.phone_number),1)]),e("span",ae,m(s.role),1)]),e("div",le,[s.role!=="super-admin"&&u.value.role==="super-admin"?(d(),n("button",{key:0,onClick:l=>y(s.id),class:"flex-1 px-3 py-2 text-xs bg-blue-600 hover:bg-blue-700 rounded text-white"}," Reset ",8,ne)):v("",!0),s.role!=="super-admin"&&u.value.role==="super-admin"?(d(),n("button",{key:1,onClick:l=>a(s.id),class:"flex-1 px-3 py-2 text-xs bg-red-600 hover:bg-red-700 rounded text-white"}," Delete ",8,de)):v("",!0)])]))),128))])]))]),b.value.show?(d(),n("div",{key:0,class:j(["fixed top-4 left-1/2 -translate-x-1/2 sm:left-auto sm:translate-x-0 sm:right-4 px-4 sm:px-6 py-3 sm:py-4 rounded-lg shadow-lg z-50",b.value.type==="success"?"bg-green-600":"bg-red-600"])},[e("span",ie,m(b.value.message),1)],2)):v("",!0)])])]))}};R(ce).mount("#app");
