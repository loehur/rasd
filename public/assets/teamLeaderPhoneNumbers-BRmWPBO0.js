import{r as u,j as V,c as o,o as a,a as e,d as g,w as E,e as b,v,g as N,t as l,F as $,l as F,n as L,h as R}from"./tailwind-Cyk5UPZk.js";import{A as P}from"./api-rG_fphBW.js";const q={class:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50"},O={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},J={key:0,class:"mb-8 bg-white rounded-xl shadow-sm p-6 border border-gray-200"},Y={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Q={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},G={class:"flex justify-end"},H=["disabled"],K={key:1,class:"mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4"},W={key:2,class:"mb-6 bg-green-50 border border-green-200 rounded-lg p-4"},X={class:"bg-white rounded-xl shadow-sm border border-gray-200"},Z={class:"px-6 py-4 border-b border-gray-200"},ee={class:"flex items-center justify-between"},te={class:"text-sm text-gray-600"},se={class:"mt-4"},re={class:"flex gap-3"},oe={class:"flex-1"},ae={key:0,class:"mt-1 text-sm text-red-600"},le=["disabled"],ne={key:0,class:"p-8 text-center"},de={key:1,class:"p-8 text-center text-red-600"},ie={key:2,class:"overflow-x-auto"},ue={class:"w-full"},pe={class:"bg-white divide-y divide-gray-200"},me={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},ce={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ge={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-600"},be={class:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-blue-600"},ve={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-600"},xe={key:0,class:"relative group"},he={class:"absolute z-50 invisible group-hover:visible bg-gray-800 text-white text-xs rounded-lg py-2 px-3 bottom-full left-1/2 transform -translate-x-1/2 mb-2 w-48 max-w-xs shadow-xl"},ye={key:1,class:"text-gray-400"},fe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-600"},we={key:3,class:"p-8 text-center text-gray-500"},_e={key:4,class:"px-6 py-4 border-t border-gray-200 flex items-center justify-between"},ke={class:"text-sm text-gray-600"},Ne={class:"flex gap-2"},Se=["disabled"],Pe=["disabled"],je={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Ce={class:"bg-white rounded-xl shadow-xl p-6 max-w-md w-full mx-4"},Ae={class:"flex gap-3 justify-end"},Ee=["disabled"],Me={class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ie={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},ze={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},Be={__name:"PhoneNumbersApp",setup(De){const S=u([]),w=u(!0),_=u(""),c=u(!1),x=u(""),h=u({show:!1,message:"",type:"success"}),i=u(""),y=u(""),j=u(!1),p=u({id:null,phone_number:"",remarks:""}),d=u({current_page:1,per_page:20,total:0,total_pages:0,has_prev:!1,has_next:!1}),n=u({employeeId:"",employeeName:"",teamLeaderName:"",phoneNumber:"",remarks:""});V(()=>{const r=JSON.parse(localStorage.getItem("tl_user")||"{}");x.value=r.role||"",x.value==="staff"&&(n.value.employeeId=r.employee_id||"",n.value.employeeName=r.name||""),f()});const f=async(r=1)=>{w.value=!0,_.value="";try{const t=localStorage.getItem("tl_auth_token"),s=new URLSearchParams;s.append("page",r),s.append("per_page",20),i.value&&i.value.length>=8&&s.append("search",i.value);const k=await(await fetch(`${P}/api/phone-numbers?${s.toString()}`,{headers:{Authorization:`Bearer ${t}`,Accept:"application/json"}})).json();k.success?(S.value=k.data,k.pagination&&(d.value=k.pagination)):_.value=k.message||"Failed to fetch phone numbers"}catch(t){_.value="Failed to connect to server",console.error("Error:",t)}finally{w.value=!1}},C=r=>{r>=1&&r<=d.value.total_pages&&f(r)},M=async()=>{if(!n.value.phoneNumber.trim()){m("Please enter a phone number","error");return}if(!n.value.remarks.trim()){m("Please enter remarks","error");return}c.value=!0;try{const r=localStorage.getItem("tl_auth_token"),s=await(await fetch(`${P}/api/phone-numbers`,{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({phone_number:n.value.phoneNumber,remarks:n.value.remarks})})).json();s.success?(m("Phone number added successfully!","success"),n.value.phoneNumber="",n.value.remarks="",f()):m(s.message||"Failed to add phone number","error")}catch(r){m("Failed to connect to server","error"),console.error("Error:",r)}finally{c.value=!1}},I=r=>r?new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-",m=(r,t="success")=>{h.value={show:!0,message:r,type:t},setTimeout(()=>{h.value.show=!1},3e3)},z=()=>{y.value="",i.value.length>0&&i.value.length<8&&(y.value="Please enter at least 8 digits")},B=async()=>{if(i.value.length>0&&i.value.length<8){y.value="Please enter at least 8 digits";return}f()},D=()=>{i.value="",y.value="",f()},U=async()=>{if(!p.value.phone_number.trim()){m("Please enter a phone number","error");return}if(!p.value.remarks.trim()){m("Please enter remarks","error");return}c.value=!0;try{const r=localStorage.getItem("tl_auth_token"),s=await(await fetch(`${P}/api/phone-numbers/${p.value.id}`,{method:"PUT",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({phone_number:p.value.phone_number,remarks:p.value.remarks})})).json();s.success?(m("Phone number updated successfully!","success"),A(),f()):m(s.message||"Failed to update phone number","error")}catch(r){m("Failed to connect to server","error"),console.error("Error:",r)}finally{c.value=!1}},A=()=>{j.value=!1,p.value={id:null,phone_number:"",remarks:""}},T=()=>{localStorage.removeItem("tl_auth_token"),localStorage.removeItem("tl_user"),window.location.href="/"};return(r,t)=>(a(),o("div",q,[e("header",{class:"bg-gradient-to-r from-slate-50 via-indigo-50 to-sky-50 text-slate-800 border-b border-slate-200 shadow-sm"},[e("div",{class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4"},[e("div",{class:"flex justify-between items-center"},[t[10]||(t[10]=e("div",null,[e("h1",{class:"text-2xl font-bold tracking-tight"},"Phone Numbers"),e("p",{class:"text-sm text-slate-600 mt-1"},"Manage phone number entries")],-1)),e("div",{class:"flex items-center gap-4"},[t[9]||(t[9]=e("a",{href:"/team-leader/dashboard",class:"text-sm text-slate-600 hover:text-slate-900"}," ← Back to Dashboard ",-1)),e("button",{onClick:T,class:"px-4 py-2 text-sm font-medium bg-red-600 text-white rounded-lg hover:bg-red-700"}," Logout ")])])])]),e("main",O,[x.value==="staff"?(a(),o("div",J,[t[15]||(t[15]=e("h2",{class:"text-lg font-bold text-gray-900 mb-4"},"Add New Phone Number",-1)),e("form",{onSubmit:E(M,["prevent"]),class:"space-y-4"},[e("div",Y,[e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Employee ID ",-1)),b(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>n.value.employeeId=s),type:"text",readonly:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-50"},null,512),[[v,n.value.employeeId]])]),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Employee Name ",-1)),b(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>n.value.employeeName=s),type:"text",readonly:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-50"},null,512),[[v,n.value.employeeName]])])]),e("div",Q,[e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[N(" Phone Number "),e("span",{class:"text-red-500"},"*")],-1)),b(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>n.value.phoneNumber=s),type:"tel",required:"",placeholder:"Enter phone number",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,512),[[v,n.value.phoneNumber]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[N(" Remarks "),e("span",{class:"text-red-500"},"*")],-1)),b(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>n.value.remarks=s),type:"text",required:"",placeholder:"Enter remarks (required)",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,512),[[v,n.value.remarks]])])]),e("div",G,[e("button",{type:"submit",disabled:c.value,class:"px-6 py-2 bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-semibold rounded-lg hover:from-blue-700 hover:to-indigo-700 disabled:opacity-50"},l(c.value?"Adding...":"Add Phone Number"),9,H)])],32)])):g("",!0),x.value==="team_leader"?(a(),o("div",K,[...t[16]||(t[16]=[e("div",{class:"flex items-start gap-3"},[e("svg",{class:"w-5 h-5 text-blue-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("p",{class:"text-sm text-blue-800"}," You are viewing phone numbers from your team. Staff can add entries, but only admin can edit or delete. ")],-1)])])):g("",!0),x.value==="staff"?(a(),o("div",W,[...t[17]||(t[17]=[e("div",{class:"flex items-start gap-3"},[e("svg",{class:"w-5 h-5 text-green-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("p",{class:"text-sm text-green-800"}," You can add new phone numbers using the form above. Only admin can edit or delete entries. ")],-1)])])):g("",!0),e("div",X,[e("div",Z,[e("div",ee,[t[18]||(t[18]=e("h2",{class:"text-lg font-bold text-gray-900"},"Phone Numbers List",-1)),e("div",te," Showing "+l(d.value.total>0?(d.value.current_page-1)*d.value.per_page+1:0)+" - "+l(Math.min(d.value.current_page*d.value.per_page,d.value.total))+" of "+l(d.value.total)+" entries ",1)]),e("div",se,[e("div",re,[e("div",oe,[b(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>i.value=s),type:"text",placeholder:"Search phone number (min. 8 digits)",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",onInput:z},null,544),[[v,i.value]]),y.value?(a(),o("p",ae,l(y.value),1)):g("",!0)]),e("button",{onClick:B,disabled:i.value.length>0&&i.value.length<8,class:"px-6 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed"}," Search ",8,le),i.value?(a(),o("button",{key:0,onClick:D,class:"px-6 py-2 bg-gray-600 text-white font-semibold rounded-lg hover:bg-gray-700"}," Clear ")):g("",!0)])])]),w.value?(a(),o("div",ne,[...t[19]||(t[19]=[e("div",{class:"inline-block h-8 w-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"},null,-1),e("p",{class:"mt-2 text-gray-600"},"Loading...",-1)])])):_.value?(a(),o("div",de,l(_.value),1)):S.value.length>0?(a(),o("div",ie,[e("table",ue,[t[22]||(t[22]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Employee ID "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Employee Name "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Team Leader "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Phone Number "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Remarks "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Date Added ")])],-1)),e("tbody",pe,[(a(!0),o($,null,F(S.value,s=>(a(),o("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",me,l(s.staff_id),1),e("td",ce,l(s.employee_name),1),e("td",ge,l(s.team_leader_name||"-"),1),e("td",be,l(s.phone_number),1),e("td",ve,[s.remarks?(a(),o("div",xe,[t[21]||(t[21]=e("svg",{class:"w-5 h-5 text-amber-500 cursor-help",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("div",he,[N(l(s.remarks)+" ",1),t[20]||(t[20]=e("div",{class:"absolute top-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-t-gray-800"},null,-1))])])):(a(),o("span",ye,"-"))]),e("td",fe,l(I(s.created_at)),1)]))),128))])])])):(a(),o("div",we," No phone numbers found. "+l(x.value==="staff"?"Add your first entry above!":""),1)),S.value.length>0?(a(),o("div",_e,[e("div",ke," Page "+l(d.value.current_page)+" of "+l(d.value.total_pages),1),e("div",Ne,[e("button",{onClick:t[5]||(t[5]=s=>C(d.value.current_page-1)),disabled:!d.value.has_prev||w.value,class:"px-4 py-2 bg-gray-200 text-gray-700 font-medium rounded-lg hover:bg-gray-300 disabled:opacity-40 disabled:cursor-not-allowed transition-colors"}," ← Previous ",8,Se),e("button",{onClick:t[6]||(t[6]=s=>C(d.value.current_page+1)),disabled:!d.value.has_next||w.value,class:"px-4 py-2 bg-gray-200 text-gray-700 font-medium rounded-lg hover:bg-gray-300 disabled:opacity-40 disabled:cursor-not-allowed transition-colors"}," Next → ",8,Pe)])])):g("",!0)])]),j.value?(a(),o("div",je,[e("div",Ce,[t[25]||(t[25]=e("h3",{class:"text-xl font-bold text-gray-900 mb-4"},"Edit Phone Number",-1)),e("form",{onSubmit:E(U,["prevent"]),class:"space-y-4"},[e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[N(" Phone Number "),e("span",{class:"text-red-500"},"*")],-1)),b(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>p.value.phone_number=s),type:"tel",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,512),[[v,p.value.phone_number]])]),e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[N(" Remarks "),e("span",{class:"text-red-500"},"*")],-1)),b(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>p.value.remarks=s),type:"text",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,512),[[v,p.value.remarks]])]),e("div",Ae,[e("button",{type:"button",onClick:A,class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50"}," Cancel "),e("button",{type:"submit",disabled:c.value,class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50"},l(c.value?"Saving...":"Save Changes"),9,Ee)])],32)])])):g("",!0),h.value.show?(a(),o("div",{key:1,class:L(["fixed top-4 right-4 px-6 py-4 rounded-lg shadow-lg z-50 flex items-center space-x-3",h.value.type==="success"?"bg-green-500":"bg-red-500","text-white"])},[(a(),o("svg",Me,[h.value.type==="success"?(a(),o("path",Ie)):(a(),o("path",ze))])),e("span",null,l(h.value.message),1)],2)):g("",!0)]))}};R(Be).mount("#app");
