import{r as i,i as w,j as N,c as n,o as a,a as e,e as k,t as s,d as M,h as V,F as C,k as S,n as j,b as D}from"./tailwind-D51w7yuY.js";import{A as I}from"./api-n_PshMHp.js";async function P(){const h=localStorage.getItem("tl_auth_token");return await(await fetch(`${I}/api/team-leader/staff`,{method:"GET",headers:{Authorization:`Bearer ${h}`,"Content-Type":"application/json"}})).json()}const H={class:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50"},E={class:"bg-white shadow-sm border-b border-gray-200"},F={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4"},R={class:"flex justify-between items-center"},$={class:"text-sm text-gray-600 mt-1"},U={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},O={class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"},G={class:"bg-white rounded-xl shadow-sm p-6 border border-gray-200"},J={class:"flex items-center"},W={class:"ml-4"},q={class:"text-2xl font-bold text-gray-900"},K={class:"bg-white rounded-xl shadow-sm p-6 border border-gray-200"},Q={class:"flex items-center"},X={class:"ml-4"},Y={class:"text-lg font-bold text-gray-900"},Z={class:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden"},ee={class:"p-6"},te={key:0,class:"text-center py-12"},se={key:1,class:"text-center py-12"},oe={class:"text-gray-600"},re={key:2,class:"text-center py-12"},ne={key:3},ae={class:"mb-4 flex justify-between items-center"},ie={class:"text-sm text-gray-600"},le={class:"overflow-hidden border border-gray-200 rounded-lg"},de={class:"min-w-full divide-y divide-gray-200"},ce={class:"bg-white divide-y divide-gray-200"},ue={class:"px-6 py-4 whitespace-nowrap"},ge={class:"text-sm font-medium text-gray-900"},me={class:"px-6 py-4 whitespace-nowrap"},pe={class:"flex items-center"},xe={class:"flex-shrink-0 h-10 w-10"},he={class:"h-10 w-10 rounded-full bg-gradient-to-br from-indigo-400 to-purple-400 flex items-center justify-center text-white font-semibold"},ve={class:"ml-4"},fe={class:"text-sm font-medium text-gray-900"},ye={class:"px-6 py-4 whitespace-nowrap"},be={class:"text-sm text-gray-900"},_e={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},we={class:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"},ke={class:"p-6 border-b border-gray-200 bg-gradient-to-r from-indigo-50 to-purple-50"},Me={class:"text-sm text-gray-600 mt-1"},Ce={class:"p-6"},Se={class:"space-y-4"},je={class:"flex items-center flex-1"},Ae={class:"flex-shrink-0 h-10 w-10"},ze={class:"h-10 w-10 rounded-full bg-gradient-to-br from-indigo-400 to-purple-400 flex items-center justify-center text-white font-semibold"},Be={class:"ml-4"},Te={class:"text-sm font-medium text-gray-900"},Le={class:"text-xs text-gray-500"},Ne={class:"flex space-x-2"},Ve=["onClick"],De=["onClick"],Ie={class:"p-6 border-t border-gray-200 bg-gray-50 flex justify-end space-x-3"},Pe=["disabled"],He={key:1,class:"fixed top-4 right-4 bg-green-500 text-white px-6 py-4 rounded-lg shadow-lg z-50 flex items-center space-x-3"},Ee={__name:"DashboardApp",setup(h){const m=i(""),l=i([]),p=i(!0),d=i(""),x=i(!1),c=i({}),u=i(!1),g=i(""),A=w(()=>l.value.length),v=w(()=>new Date().toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}));N(()=>{const o=JSON.parse(localStorage.getItem("tl_user")||"{}");m.value=o.name||"Team Leader",f()});const f=async()=>{p.value=!0,d.value="";try{if(!localStorage.getItem("tl_auth_token")){d.value="Not authenticated",window.location.href="/";return}const t=await P();t.success?l.value=t.data||[]:d.value=t.message||"Failed to load staff list"}catch(o){d.value="Failed to load staff list. Please try again.",console.error("Error fetching staff:",o)}finally{p.value=!1}},y=o=>{if(!o)return"?";const t=o.split(" ");return t.length===1?t[0].substring(0,2).toUpperCase():(t[0][0]+t[t.length-1][0]).toUpperCase()},z=()=>{c.value={},x.value=!0},b=()=>{x.value=!1,c.value={}},_=(o,t)=>{c.value[o]=t},B=async()=>{const o=Object.keys(c.value).length;if(o===0){alert("Please mark attendance for at least one staff member");return}u.value=!0;try{await new Promise(t=>setTimeout(t,1e3)),b(),g.value=`Attendance recorded for ${o} staff member(s)`,setTimeout(()=>{g.value=""},3e3)}catch(t){alert("Failed to submit attendance. Please try again."),console.error("Error submitting attendance:",t)}finally{u.value=!1}},T=()=>{localStorage.removeItem("tl_auth_token"),localStorage.removeItem("tl_user"),window.location.href="/"};return(o,t)=>(a(),n("div",H,[e("header",E,[e("div",F,[e("div",R,[e("div",null,[t[0]||(t[0]=e("h1",{class:"text-2xl font-bold text-gray-900"},"Team Leader Dashboard",-1)),e("p",$,"Welcome, "+s(m.value),1)]),e("button",{onClick:T,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors"}," Logout ")])])]),e("main",U,[e("div",O,[e("div",G,[e("div",J,[t[2]||(t[2]=e("div",{class:"p-3 rounded-lg bg-blue-100"},[e("svg",{class:"w-8 h-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})])],-1)),e("div",W,[t[1]||(t[1]=e("p",{class:"text-sm font-medium text-gray-600"},"Total Staff",-1)),e("p",q,s(A.value),1)])])]),t[5]||(t[5]=M('<div class="bg-white rounded-xl shadow-sm p-6 border border-gray-200"><div class="flex items-center"><div class="p-3 rounded-lg bg-green-100"><svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div><div class="ml-4"><p class="text-sm font-medium text-gray-600">Present Today</p><p class="text-2xl font-bold text-gray-900">0</p></div></div></div>',1)),e("div",K,[e("div",Q,[t[4]||(t[4]=e("div",{class:"p-3 rounded-lg bg-purple-100"},[e("svg",{class:"w-8 h-8 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})])],-1)),e("div",X,[t[3]||(t[3]=e("p",{class:"text-sm font-medium text-gray-600"},"Today's Date",-1)),e("p",Y,s(v.value),1)])])])]),e("div",Z,[t[12]||(t[12]=M('<div class="p-6 border-b border-gray-200 bg-gradient-to-r from-indigo-50 to-purple-50"><h2 class="text-xl font-bold text-gray-900 flex items-center"><svg class="w-6 h-6 mr-2 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path></svg> Staff Attendance </h2><p class="text-sm text-gray-600 mt-1">Record attendance for your team members</p></div>',1)),e("div",ee,[p.value?(a(),n("div",te,[...t[6]||(t[6]=[e("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"},null,-1),e("p",{class:"mt-4 text-gray-600"},"Loading staff list...",-1)])])):d.value?(a(),n("div",se,[t[7]||(t[7]=e("svg",{class:"w-16 h-16 text-red-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("p",oe,s(d.value),1),e("button",{onClick:f,class:"mt-4 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors"}," Retry ")])):l.value.length===0?(a(),n("div",re,[...t[8]||(t[8]=[e("svg",{class:"w-16 h-16 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})],-1),e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No Staff Members",-1),e("p",{class:"text-gray-600"},"No staff members are assigned under your supervision yet.",-1)])])):(a(),n("div",ne,[e("div",ae,[e("p",ie,s(l.value.length)+" staff member(s) under your supervision",1),e("button",{onClick:z,class:"px-6 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-semibold rounded-lg hover:from-indigo-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-all shadow-md hover:shadow-lg"},[...t[9]||(t[9]=[e("svg",{class:"w-5 h-5 inline-block mr-2 -mt-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})],-1),V(" Record Attendance ",-1)])])]),e("div",le,[e("table",de,[t[11]||(t[11]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Employee ID"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Name"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Position"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status")])],-1)),e("tbody",ce,[(a(!0),n(C,null,S(l.value,r=>(a(),n("tr",{key:r.employee_id,class:"hover:bg-gray-50 transition-colors"},[e("td",ue,[e("div",ge,s(r.employee_id),1)]),e("td",me,[e("div",pe,[e("div",xe,[e("div",he,s(y(r.name)),1)]),e("div",ve,[e("div",fe,s(r.name),1)])])]),e("td",ye,[e("div",be,s(r.position||"-"),1)]),t[10]||(t[10]=e("td",{class:"px-6 py-4 whitespace-nowrap"},[e("span",{class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800"}," Active ")],-1))]))),128))])])])]))])])]),x.value?(a(),n("div",_e,[e("div",we,[e("div",ke,[t[13]||(t[13]=e("h3",{class:"text-xl font-bold text-gray-900"},"Record Attendance",-1)),e("p",Me,"Mark attendance for "+s(v.value),1)]),e("div",Ce,[e("div",Se,[(a(!0),n(C,null,S(l.value,r=>(a(),n("div",{key:r.employee_id,class:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors"},[e("div",je,[e("div",Ae,[e("div",ze,s(y(r.name)),1)]),e("div",Be,[e("div",Te,s(r.name),1),e("div",Le,s(r.employee_id),1)])]),e("div",Ne,[e("button",{onClick:L=>_(r.employee_id,"present"),class:j(["px-4 py-2 text-sm font-medium rounded-lg transition-all",c.value[r.employee_id]==="present"?"bg-green-600 text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"])}," Present ",10,Ve),e("button",{onClick:L=>_(r.employee_id,"absent"),class:j(["px-4 py-2 text-sm font-medium rounded-lg transition-all",c.value[r.employee_id]==="absent"?"bg-red-600 text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"])}," Absent ",10,De)])]))),128))])]),e("div",Ie,[e("button",{onClick:b,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors"}," Cancel "),e("button",{onClick:B,disabled:u.value,class:"px-6 py-2 text-sm font-medium text-white bg-gradient-to-r from-indigo-600 to-purple-600 rounded-lg hover:from-indigo-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-all disabled:opacity-50 disabled:cursor-not-allowed"},s(u.value?"Submitting...":"Submit Attendance"),9,Pe)])])])):k("",!0),g.value?(a(),n("div",He,[t[14]||(t[14]=e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("span",null,s(g.value),1)])):k("",!0)]))}};D(Ee).mount("#app");
